# ğŸš€ CookTip å‰ç«¯æ¥å£å¯¹æ¥æŒ‡å—

**æ›´æ–°æ—¶é—´**: 2025å¹´10æœˆ5æ—¥ 17:18  
**çŠ¶æ€**: âœ… åç«¯æ¥å£å·²å…¨éƒ¨éƒ¨ç½²æˆåŠŸ

---

## ğŸ“Š å½“å‰çŠ¶æ€

### âœ… åç«¯æ¥å£çŠ¶æ€

**æœ€æ–°éƒ¨ç½²**: 
- åœ°å€: `https://cooktip-backend-1c2ldu3a8-davids-projects-688aeefc.vercel.app`
- çŠ¶æ€: âœ… 100% å¯ç”¨
- æ‰€æœ‰æ¥å£: å…¨éƒ¨æ­£å¸¸

**å›ºå®šåŸŸå**:
- åœ°å€: `https://cooktip-backend.vercel.app`
- çŠ¶æ€: â³ CDN æ›´æ–°ä¸­ï¼ˆé¢„è®¡ 10-15 åˆ†é’Ÿï¼‰
- éƒ¨åˆ†æ¥å£: å¯èƒ½è¿”å› 404

---

## ğŸ¯ å‰ç«¯ç«‹å³è¡ŒåŠ¨æ–¹æ¡ˆ

### æ–¹æ¡ˆ 1: ä½¿ç”¨æœ€æ–°éƒ¨ç½²åœ°å€ï¼ˆâ­ æ¨è - ç«‹å³å¯ç”¨ï¼‰

**åœ¨å°ç¨‹åºé…ç½®æ–‡ä»¶ä¸­è®¾ç½®**:

```javascript
// utils/config.js
export default {
  // ä½¿ç”¨æœ€æ–°éƒ¨ç½²åœ°å€ï¼ˆç«‹å³å¯ç”¨ï¼‰
  API_BASE_URL: 'https://cooktip-backend-1c2ldu3a8-davids-projects-688aeefc.vercel.app'
}
```

**ä¼˜ç‚¹**:
- âœ… ç«‹å³å¯ç”¨ï¼Œæ— éœ€ç­‰å¾…
- âœ… 100% æ¥å£å¯ç”¨
- âœ… å·²é€šè¿‡å®Œæ•´æµ‹è¯•

**ç¼ºç‚¹**:
- âš ï¸ æ¯æ¬¡åç«¯é‡æ–°éƒ¨ç½²æ—¶åœ°å€ä¼šå˜ï¼ˆéœ€è¦æ›´æ–°ï¼‰

---

### æ–¹æ¡ˆ 2: ç­‰å¾…å›ºå®šåŸŸåç”Ÿæ•ˆï¼ˆæ›´ç¨³å®šï¼‰

**é¢„è®¡ç­‰å¾…æ—¶é—´**: 10-15 åˆ†é’Ÿ

**æ“ä½œæ­¥éª¤**:
1. ç­‰å¾… 15 åˆ†é’Ÿ
2. åœ¨é…ç½®ä¸­ä½¿ç”¨å›ºå®šåŸŸå:

```javascript
// utils/config.js
export default {
  // ä½¿ç”¨å›ºå®šåŸŸåï¼ˆæ°¸ä¹…ä¸å˜ï¼‰
  API_BASE_URL: 'https://cooktip-backend.vercel.app'
}
```

**ä¼˜ç‚¹**:
- âœ… åœ°å€æ°¸ä¹…ä¸å˜
- âœ… åç«¯é‡æ–°éƒ¨ç½²ä¸å½±å“å‰ç«¯

**ç¼ºç‚¹**:
- â³ éœ€è¦ç­‰å¾… CDN æ›´æ–°

---

## ğŸ§ª å¦‚ä½•éªŒè¯æ¥å£å¯ç”¨

### æ–¹æ³• 1: åœ¨å°ç¨‹åºä¸­æµ‹è¯•

```javascript
// åœ¨å°ç¨‹åºä»»æ„é¡µé¢çš„ onLoad ä¸­æµ‹è¯•
onLoad() {
  wx.request({
    url: 'https://cooktip-backend-1c2ldu3a8-davids-projects-688aeefc.vercel.app/api/auth/wechat',
    method: 'POST',
    data: { code: 'test' },
    success: (res) => {
      console.log('æ¥å£æµ‹è¯•ç»“æœ:', res.data);
      
      // çœ‹åˆ°ä»¥ä¸‹ä»»ä¸€å“åº”è¯´æ˜æ¥å£å¯ç”¨ï¼š
      // { code: 401, message: "å¾®ä¿¡ç™»å½•å¤±è´¥" } - æ­£å¸¸ï¼ˆæµ‹è¯• code æ— æ•ˆï¼‰
      // { code: 200, message: "ç™»å½•æˆåŠŸ" } - å®Œç¾
    },
    fail: (err) => {
      console.error('æ¥å£æµ‹è¯•å¤±è´¥:', err);
      // å¦‚æœçœ‹åˆ° 404ï¼Œè¯´æ˜åœ°å€ä¸å¯¹æˆ– CDN æœªæ›´æ–°
    }
  });
}
```

### æ–¹æ³• 2: ä½¿ç”¨æµè§ˆå™¨æµ‹è¯•

æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼Œæ‰§è¡Œ:

```javascript
fetch('https://cooktip-backend-1c2ldu3a8-davids-projects-688aeefc.vercel.app/api/auth/wechat', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ code: 'test' })
})
.then(res => res.json())
.then(data => console.log('æµ‹è¯•ç»“æœ:', data))
.catch(err => console.error('æµ‹è¯•å¤±è´¥:', err));
```

**é¢„æœŸç»“æœ**:
- âœ… è¿”å› `{ code: 401 }` æˆ– `{ code: 400 }` - æ¥å£å­˜åœ¨ä¸”æ­£å¸¸
- âŒ è¿”å› `404` - æ¥å£ä¸å­˜åœ¨æˆ– CDN æœªæ›´æ–°

---

## ğŸ“¡ å¯ç”¨çš„æ¥å£åˆ—è¡¨

### âœ… è®¤è¯æ¥å£

| æ¥å£ | æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | çŠ¶æ€ |
|------|------|------|------|------|
| å¾®ä¿¡ç™»å½• | POST | `/api/auth/wechat` | å°ç¨‹åºç™»å½•/æ³¨å†Œ | âœ… å¯ç”¨ |

### âœ… èœè°±æ¥å£

| æ¥å£ | æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | çŠ¶æ€ |
|------|------|------|------|------|
| èœè°±åˆ—è¡¨ | GET | `/api/recipes` | è·å–èœè°±åˆ—è¡¨ | âœ… å¯ç”¨ |
| èœè°±è¯¦æƒ… | GET | `/api/recipes/:id` | è·å–èœè°±è¯¦æƒ… | âœ… å¯ç”¨ |

### âœ… åˆ†ç±»æ¥å£

| æ¥å£ | æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | çŠ¶æ€ |
|------|------|------|------|------|
| åˆ†ç±»åˆ—è¡¨ | GET | `/api/categories` | è·å–åˆ†ç±»åˆ—è¡¨ | âœ… å¯ç”¨ |

### âœ… æœç´¢æ¥å£

| æ¥å£ | æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | çŠ¶æ€ |
|------|------|------|------|------|
| æœç´¢èœè°± | GET | `/api/search?q=å…³é”®è¯` | æœç´¢èœè°± | âœ… å¯ç”¨ |

### âœ… ç”¨æˆ·æ¥å£

| æ¥å£ | æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | çŠ¶æ€ |
|------|------|------|------|------|
| å½“å‰ç”¨æˆ·ä¿¡æ¯ | GET | `/api/user/info` | è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯ï¼ˆéœ€ç™»å½•ï¼‰ | âœ… å¯ç”¨ |
| ç”¨æˆ·èœè°±åˆ—è¡¨ | GET | `/api/user/recipes` | è·å–å½“å‰ç”¨æˆ·çš„èœè°±ï¼ˆéœ€ç™»å½•ï¼‰ | âœ… å¯ç”¨ |
| æŒ‡å®šç”¨æˆ·ä¿¡æ¯ | GET | `/api/users/:id` | è·å–æŒ‡å®šç”¨æˆ·ä¿¡æ¯ | âœ… å¯ç”¨ |

### âœ… æ”¶è—æ¥å£

| æ¥å£ | æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | çŠ¶æ€ |
|------|------|------|------|------|
| æ”¶è—åˆ—è¡¨ | GET | `/api/favorites` | è·å–æ”¶è—åˆ—è¡¨ï¼ˆéœ€ç™»å½•ï¼‰ | âœ… å¯ç”¨ |
| æ·»åŠ æ”¶è— | POST | `/api/favorites` | æ·»åŠ æ”¶è—ï¼ˆéœ€ç™»å½•ï¼‰ | âœ… å¯ç”¨ |
| å–æ¶ˆæ”¶è— | DELETE | `/api/favorites/:id` | å–æ¶ˆæ”¶è—ï¼ˆéœ€ç™»å½•ï¼‰ | âœ… å¯ç”¨ |

### âœ… ç‚¹èµæ¥å£

| æ¥å£ | æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | çŠ¶æ€ |
|------|------|------|------|------|
| æ·»åŠ ç‚¹èµ | POST | `/api/likes` | ç»™èœè°±ç‚¹èµï¼ˆéœ€ç™»å½•ï¼‰ | âœ… å¯ç”¨ |

### âœ… è¯„è®ºæ¥å£

| æ¥å£ | æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | çŠ¶æ€ |
|------|------|------|------|------|
| è¯„è®ºåˆ—è¡¨ | GET | `/api/comments?recipeId=xxx` | è·å–è¯„è®ºåˆ—è¡¨ | âœ… å¯ç”¨ |
| æ·»åŠ è¯„è®º | POST | `/api/comments` | æ·»åŠ è¯„è®ºï¼ˆéœ€ç™»å½•ï¼‰ | âœ… å¯ç”¨ |
| åˆ é™¤è¯„è®º | DELETE | `/api/comments/:id` | åˆ é™¤è¯„è®ºï¼ˆéœ€ç™»å½•ï¼‰ | âœ… å¯ç”¨ |

---

## ğŸ” è®¤è¯è¯´æ˜

### éœ€è¦è®¤è¯çš„æ¥å£

ä»¥ä¸‹æ¥å£éœ€è¦åœ¨è¯·æ±‚å¤´ä¸­æºå¸¦ token:

```javascript
wx.request({
  url: 'https://..../api/user/info',
  method: 'GET',
  header: {
    'Authorization': `Bearer ${token}` // ä»ç™»å½•æ¥å£è·å–çš„ token
  }
})
```

**éœ€è¦è®¤è¯çš„æ¥å£**:
- `/api/user/info`
- `/api/user/recipes`
- `/api/favorites` (æ‰€æœ‰æ“ä½œ)
- `/api/likes` (æ‰€æœ‰æ“ä½œ)
- `/api/comments` (æ·»åŠ ã€åˆ é™¤)

### ä¸éœ€è¦è®¤è¯çš„æ¥å£

ä»¥ä¸‹æ¥å£å¯ä»¥ç›´æ¥è®¿é—®:
- `/api/auth/wechat` (ç™»å½•æ¥å£)
- `/api/recipes` (èœè°±åˆ—è¡¨å’Œè¯¦æƒ…)
- `/api/categories` (åˆ†ç±»åˆ—è¡¨)
- `/api/search` (æœç´¢)
- `/api/users/:id` (æŸ¥çœ‹å…¶ä»–ç”¨æˆ·)
- `/api/comments?recipeId=xxx` (æŸ¥çœ‹è¯„è®º)

---

## ğŸš€ å®Œæ•´çš„ç™»å½•æµç¨‹ç¤ºä¾‹

```javascript
// 1. è°ƒç”¨å¾®ä¿¡ç™»å½•
async login() {
  try {
    // è·å–å¾®ä¿¡ç™»å½• code
    const { code } = await wx.login();
    
    // è°ƒç”¨åç«¯ç™»å½•æ¥å£
    const response = await wx.request({
      url: 'https://cooktip-backend-1c2ldu3a8-davids-projects-688aeefc.vercel.app/api/auth/wechat',
      method: 'POST',
      data: {
        code: code,
        nickName: 'å¼ ä¸‰',  // å¯é€‰
        avatar: 'https://...'  // å¯é€‰
      }
    });
    
    if (response.data.code === 200) {
      const { token, user } = response.data.data;
      
      // ä¿å­˜ token å’Œç”¨æˆ·ä¿¡æ¯
      wx.setStorageSync('token', token);
      wx.setStorageSync('user', user);
      
      console.log('ç™»å½•æˆåŠŸ:', user);
      return true;
    } else {
      console.error('ç™»å½•å¤±è´¥:', response.data.message);
      return false;
    }
    
  } catch (error) {
    console.error('ç™»å½•å¼‚å¸¸:', error);
    return false;
  }
}

// 2. ä½¿ç”¨ token è®¿é—®éœ€è¦è®¤è¯çš„æ¥å£
async getUserInfo() {
  const token = wx.getStorageSync('token');
  
  const response = await wx.request({
    url: 'https://cooktip-backend-1c2ldu3a8-davids-projects-688aeefc.vercel.app/api/user/info',
    method: 'GET',
    header: {
      'Authorization': `Bearer ${token}`
    }
  });
  
  return response.data;
}
```

---

## âš ï¸  å¸¸è§é—®é¢˜

### Q1: æ¥å£è¿”å› 404
**åŸå› **: 
- ä½¿ç”¨äº†å›ºå®šåŸŸåï¼Œä½† CDN è¿˜åœ¨æ›´æ–°ä¸­
- åœ°å€æ‹¼æ¥é”™è¯¯

**è§£å†³**:
- æ”¹ç”¨æœ€æ–°éƒ¨ç½²åœ°å€ï¼ˆç«‹å³å¯ç”¨ï¼‰
- æˆ–ç­‰å¾… 10-15 åˆ†é’Ÿ

### Q2: æ¥å£è¿”å› 401
**åŸå› **: 
- æ¥å£éœ€è¦è®¤è¯ï¼Œä½†æ²¡æœ‰ä¼  token
- Token è¿‡æœŸæˆ–æ— æ•ˆ

**è§£å†³**:
- æ£€æŸ¥æ˜¯å¦åœ¨ header ä¸­ä¼ é€’äº† `Authorization: Bearer {token}`
- é‡æ–°ç™»å½•è·å–æ–° token

### Q3: æ¥å£è¿”å› 500
**åŸå› **:
- æœåŠ¡å™¨å†…éƒ¨é”™è¯¯
- æ•°æ®åº“è¿æ¥é—®é¢˜

**è§£å†³**:
- æ£€æŸ¥è¯·æ±‚å‚æ•°æ˜¯å¦æ­£ç¡®
- è”ç³»åç«¯æ’æŸ¥

### Q4: å°ç¨‹åºè¯·æ±‚å¤±è´¥
**åŸå› **:
- åŸŸåæœªæ·»åŠ åˆ°å°ç¨‹åºåˆæ³•åŸŸååˆ—è¡¨

**è§£å†³**:
```
åœ¨å¾®ä¿¡å…¬ä¼—å¹³å°é…ç½®ä»¥ä¸‹åŸŸå:
- https://cooktip-backend.vercel.app
- https://cooktip-backend-1c2ldu3a8-davids-projects-688aeefc.vercel.app
```

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### åç«¯å¼€å‘äººå‘˜

å¦‚æœ‰é—®é¢˜ï¼Œæä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š
1. è¯·æ±‚çš„å®Œæ•´ URL
2. è¯·æ±‚æ–¹æ³•å’Œå‚æ•°
3. è¿”å›çš„çŠ¶æ€ç å’Œå“åº”
4. å°ç¨‹åºæ§åˆ¶å°æˆªå›¾

### æµ‹è¯•å·¥å…·

ä½¿ç”¨é¡¹ç›®ä¸­çš„ `APIæµ‹è¯•å·¥å…·.html` å¯ä»¥å¿«é€Ÿæµ‹è¯•æ‰€æœ‰æ¥å£ã€‚

---

## âœ… æ£€æŸ¥æ¸…å•

### å‰ç«¯å¼€å‘äººå‘˜æ£€æŸ¥

- [ ] å·²ä¿®æ”¹ `utils/config.js` ä¸­çš„ `API_BASE_URL`
- [ ] å·²æ¸…é™¤å°ç¨‹åºç¼“å­˜
- [ ] å·²åœ¨å°ç¨‹åºåå°é…ç½®åˆæ³•åŸŸå
- [ ] å·²æµ‹è¯•ç™»å½•æ¥å£ï¼ˆè¿”å› 401 æˆ– 200ï¼‰
- [ ] å·²æµ‹è¯•å…¶ä»–æ¥å£ï¼ˆè¿”å›æ­£å¸¸æ•°æ®ï¼‰
- [ ] å·²æ­£ç¡®å¤„ç† tokenï¼ˆç™»å½•åä¿å­˜ï¼Œè¯·æ±‚æ—¶æºå¸¦ï¼‰

---

## ğŸ‰ æ€»ç»“

### å½“å‰çŠ¶æ€
- âœ… åç«¯æ¥å£ 100% å¯ç”¨
- âœ… æœ€æ–°éƒ¨ç½²åœ°å€ç«‹å³å¯ç”¨
- â³ å›ºå®šåŸŸå 10-15 åˆ†é’Ÿåå¯ç”¨

### å»ºè®®æ“ä½œ
1. **ç«‹å³**: ä½¿ç”¨æœ€æ–°éƒ¨ç½²åœ°å€å¼€å§‹å¼€å‘
2. **15åˆ†é’Ÿå**: æµ‹è¯•å›ºå®šåŸŸåæ˜¯å¦å¯ç”¨
3. **å›ºå®šåŸŸåå¯ç”¨å**: åˆ‡æ¢åˆ°å›ºå®šåŸŸå

---

**åˆ›å»ºæ—¶é—´**: 2025å¹´10æœˆ5æ—¥ 17:18  
**åç«¯çŠ¶æ€**: âœ… å…¨éƒ¨æ­£å¸¸  
**å‰ç«¯å¯ä»¥å¼€å§‹é›†æˆ**: âœ… æ˜¯

