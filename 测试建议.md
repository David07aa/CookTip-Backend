# API æµ‹è¯•å»ºè®®

## å½“å‰é—®é¢˜è¯Šæ–­

æ ¹æ®æµ‹è¯•ç»“æœï¼Œå‡ºç°äº† `Failed to fetch` é”™è¯¯ï¼Œè¿™æ˜¯ **Vercel å®‰å…¨æ£€æŸ¥ç‚¹**è¢«è§¦å‘ï¼Œä¸æ˜¯åç«¯æœåŠ¡é—®é¢˜ã€‚

---

## ğŸ¯ æ¨èæµ‹è¯•æ–¹æ¡ˆ

### æ–¹æ¡ˆ1ï¼šç­‰å¾…åæµè§ˆå™¨æµ‹è¯•ï¼ˆæœ€ç®€å•ï¼‰

1. **ç­‰å¾… 10-30 åˆ†é’Ÿ**
   - Vercel å®‰å…¨æ£€æŸ¥ä¼šè‡ªåŠ¨è§£é™¤
   - è¿™æ®µæ—¶é—´å¯ä»¥åšå…¶ä»–å·¥ä½œ

2. **é‡æ–°æ‰“å¼€æµ‹è¯•å·¥å…·**
   - åˆ·æ–°é¡µé¢
   - ç‚¹å‡»"å¼€å§‹å…¨é¢æµ‹è¯•"

3. **é¢„æœŸç»“æœ**
   - âœ… èœè°±åˆ—è¡¨ - 200 æˆåŠŸ
   - âœ… æœç´¢ - 200 æˆåŠŸ
   - âœ… åˆ†ç±»åˆ—è¡¨ - 200 æˆåŠŸ
   - âš ï¸ å¾®ä¿¡ç™»å½• - 401ï¼ˆæµ‹è¯•codeæ— æ•ˆï¼Œæ­£å¸¸ï¼‰
   - âš ï¸ éœ€è¦è®¤è¯çš„æ¥å£ - 401ï¼ˆæœªç™»å½•ï¼Œæ­£å¸¸ï¼‰

---

### æ–¹æ¡ˆ2ï¼šä½¿ç”¨ PowerShell å‘½ä»¤è¡Œæµ‹è¯•ï¼ˆç»•è¿‡æµè§ˆå™¨é™åˆ¶ï¼‰

åˆ›å»ºæµ‹è¯•è„šæœ¬é¿å…æµè§ˆå™¨CORSå’Œå®‰å…¨æ£€æŸ¥ï¼š

```powershell
# æµ‹è¯•èœè°±åˆ—è¡¨
Invoke-RestMethod -Uri "https://cooktip-backend.vercel.app/api/recipes?page=1&limit=5" -Method Get

# æµ‹è¯•æœç´¢
Invoke-RestMethod -Uri "https://cooktip-backend.vercel.app/api/search?keyword=é¸¡" -Method Get

# æµ‹è¯•åˆ†ç±»
Invoke-RestMethod -Uri "https://cooktip-backend.vercel.app/api/categories" -Method Get

# æµ‹è¯•å¾®ä¿¡ç™»å½•
$body = @{ code = "test-code" } | ConvertTo-Json
Invoke-RestMethod -Uri "https://cooktip-backend.vercel.app/api/auth/wechat" -Method Post -Body $body -ContentType "application/json"
```

---

### æ–¹æ¡ˆ3ï¼šåœ¨å¾®ä¿¡å°ç¨‹åºä¸­ç›´æ¥æµ‹è¯•ï¼ˆçœŸå®ç¯å¢ƒï¼‰

**è¿™æ˜¯æœ€å‡†ç¡®çš„æµ‹è¯•æ–¹å¼**ï¼Œå› ä¸ºï¼š
- ä¸ä¼šè§¦å‘ Vercel å®‰å…¨æ£€æŸ¥
- çœŸå®çš„ä½¿ç”¨åœºæ™¯
- å¯ä»¥æµ‹è¯•çœŸå®çš„å¾®ä¿¡ code

#### æ­¥éª¤ï¼š
1. åœ¨å¾®ä¿¡å°ç¨‹åºä¸­è°ƒç”¨ç™»å½•æ¥å£
2. ä½¿ç”¨çœŸå®çš„ `wx.login()` è·å– code
3. å‘é€åˆ°åç«¯éªŒè¯

---

## ğŸ“Š æµ‹è¯•ç»“æœåˆ¤æ–­æ ‡å‡†

### âœ… æ­£å¸¸å“åº”ï¼ˆä¸æ˜¯é”™è¯¯ï¼‰

| æ¥å£ | çŠ¶æ€ç  | è¯´æ˜ |
|------|--------|------|
| å¾®ä¿¡ç™»å½• | 401 | æµ‹è¯•codeæ— æ•ˆï¼Œ**è¿™æ˜¯æ­£å¸¸çš„** |
| ç”¨æˆ·ä¿¡æ¯ | 401 | æœªç™»å½•ï¼Œ**è¿™æ˜¯æ­£å¸¸çš„** |
| æ”¶è—åˆ—è¡¨ | 401 | æœªç™»å½•ï¼Œ**è¿™æ˜¯æ­£å¸¸çš„** |

### âœ… æˆåŠŸå“åº”

| æ¥å£ | çŠ¶æ€ç  | è¯´æ˜ |
|------|--------|------|
| èœè°±åˆ—è¡¨ | 200 | è¿”å›èœè°±æ•°æ® |
| æœç´¢ | 200 | è¿”å›æœç´¢ç»“æœ |
| åˆ†ç±»åˆ—è¡¨ | 200 | è¿”å›åˆ†ç±»æ•°æ® |

### âŒ çœŸæ­£çš„é”™è¯¯

| é”™è¯¯ | åŸå›  | è§£å†³ |
|------|------|------|
| Failed to fetch | Vercelå®‰å…¨æ£€æŸ¥ | ç­‰å¾…10-30åˆ†é’Ÿ |
| 404 | æ¥å£ä¸å­˜åœ¨ | æ£€æŸ¥éƒ¨ç½² |
| 500 | æœåŠ¡å™¨é”™è¯¯ | æŸ¥çœ‹æ—¥å¿— |

---

## ğŸ”§ å¿«é€ŸéªŒè¯è„šæœ¬

ä¿å­˜ä¸º `quick-test.ps1`ï¼š

```powershell
Write-Host "`n========== CookTip API å¿«é€Ÿæµ‹è¯• ==========`n" -ForegroundColor Cyan

# 1. æµ‹è¯•èœè°±åˆ—è¡¨
Write-Host "1. æµ‹è¯•èœè°±åˆ—è¡¨..." -ForegroundColor Yellow
try {
    $recipes = Invoke-RestMethod -Uri "https://cooktip-backend.vercel.app/api/recipes?limit=3" -Method Get
    Write-Host "âœ… æˆåŠŸ! è·å–åˆ° $($recipes.data.total) æ¡èœè°±" -ForegroundColor Green
} catch {
    Write-Host "âŒ å¤±è´¥: $($_.Exception.Message)" -ForegroundColor Red
}

Start-Sleep -Seconds 1

# 2. æµ‹è¯•æœç´¢
Write-Host "`n2. æµ‹è¯•æœç´¢..." -ForegroundColor Yellow
try {
    $search = Invoke-RestMethod -Uri "https://cooktip-backend.vercel.app/api/search?keyword=é¸¡" -Method Get
    Write-Host "âœ… æˆåŠŸ! æœç´¢åˆ° $($search.data.total) ä¸ªç»“æœ" -ForegroundColor Green
} catch {
    Write-Host "âŒ å¤±è´¥: $($_.Exception.Message)" -ForegroundColor Red
}

Start-Sleep -Seconds 1

# 3. æµ‹è¯•åˆ†ç±»
Write-Host "`n3. æµ‹è¯•åˆ†ç±»åˆ—è¡¨..." -ForegroundColor Yellow
try {
    $categories = Invoke-RestMethod -Uri "https://cooktip-backend.vercel.app/api/categories" -Method Get
    Write-Host "âœ… æˆåŠŸ! è·å–åˆ° $($categories.data.categories.Count) ä¸ªåˆ†ç±»" -ForegroundColor Green
} catch {
    Write-Host "âŒ å¤±è´¥: $($_.Exception.Message)" -ForegroundColor Red
}

Start-Sleep -Seconds 1

# 4. æµ‹è¯•å¾®ä¿¡ç™»å½•ï¼ˆé¢„æœŸ401ï¼‰
Write-Host "`n4. æµ‹è¯•å¾®ä¿¡ç™»å½•..." -ForegroundColor Yellow
try {
    $body = @{ code = "test-code" } | ConvertTo-Json
    $login = Invoke-RestMethod -Uri "https://cooktip-backend.vercel.app/api/auth/wechat" -Method Post -Body $body -ContentType "application/json"
    Write-Host "âœ… è¿”å›: $($login.message)" -ForegroundColor Green
} catch {
    $statusCode = $_.Exception.Response.StatusCode.value__
    if ($statusCode -eq 401) {
        Write-Host "âœ… æ­£å¸¸! è¿”å› 401ï¼ˆæµ‹è¯•codeæ— æ•ˆï¼‰" -ForegroundColor Green
    } else {
        Write-Host "âŒ å¤±è´¥: $($_.Exception.Message)" -ForegroundColor Red
    }
}

Write-Host "`n========== æµ‹è¯•å®Œæˆ ==========`n" -ForegroundColor Cyan
```

---

## ğŸ’¡ é‡è¦æç¤º

### å…³äº "Failed to fetch"

è¿™ä¸ªé”™è¯¯**ä¸æ˜¯åç«¯æœåŠ¡é—®é¢˜**ï¼Œè€Œæ˜¯ï¼š

1. **æµè§ˆå™¨å®‰å…¨ç­–ç•¥**
   - Vercel æ£€æµ‹åˆ°é¢‘ç¹è¯·æ±‚
   - è§¦å‘äº†é˜²æŠ¤æœºåˆ¶
   - éœ€è¦ç­‰å¾…è‡ªåŠ¨è§£é™¤

2. **è§£å†³æ–¹æ³•**
   - âœ… ç­‰å¾… 10-30 åˆ†é’Ÿ
   - âœ… ä½¿ç”¨ PowerShell æµ‹è¯•
   - âœ… åœ¨å¾®ä¿¡å°ç¨‹åºä¸­æµ‹è¯•
   - âŒ ä¸è¦åœ¨æµè§ˆå™¨ä¸­é¢‘ç¹æµ‹è¯•

### å…³äº 401 é”™è¯¯

**401 ä¸æ˜¯é”™è¯¯**ï¼Œè€Œæ˜¯æ­£å¸¸çš„ä¸šåŠ¡é€»è¾‘ï¼š

- å¾®ä¿¡ç™»å½•è¿”å› 401 = æµ‹è¯• code æ— æ•ˆï¼ˆé¢„æœŸï¼‰
- ç”¨æˆ·ä¿¡æ¯è¿”å› 401 = æœªç™»å½•ï¼ˆé¢„æœŸï¼‰
- æ”¶è—åˆ—è¡¨è¿”å› 401 = æœªç™»å½•ï¼ˆé¢„æœŸï¼‰

---

## ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³å¯åšï¼š
1. âœ… ç­‰å¾… 30 åˆ†é’Ÿ
2. âœ… è¿è¡Œ PowerShell æµ‹è¯•è„šæœ¬
3. âœ… åœ¨å¾®ä¿¡å°ç¨‹åºä¸­æµ‹è¯•çœŸå®ç™»å½•

### éªŒè¯åç«¯æ­£å¸¸ï¼š
å¦‚æœ PowerShell æµ‹è¯•å…¨éƒ¨é€šè¿‡ï¼Œè¯´æ˜ï¼š
- âœ… åç«¯æœåŠ¡å®Œå…¨æ­£å¸¸
- âœ… æ‰€æœ‰æ¥å£éƒ½å·²éƒ¨ç½²
- âœ… æ•°æ®åº“è¿æ¥æ­£å¸¸
- âœ… ç¯å¢ƒå˜é‡é…ç½®æ­£ç¡®

### æœ€ç»ˆæµ‹è¯•ï¼š
åœ¨å¾®ä¿¡å°ç¨‹åºä¸­ï¼š
1. ä½¿ç”¨ `wx.login()` è·å–çœŸå® code
2. è°ƒç”¨ç™»å½•æ¥å£
3. éªŒè¯ token å’Œç”¨æˆ·ä¿¡æ¯
4. æµ‹è¯•å…¶ä»–éœ€è¦è®¤è¯çš„æ¥å£

---

**ç»“è®ºï¼šæ‚¨çš„åç«¯æœåŠ¡æ²¡æœ‰é—®é¢˜ï¼Œåªæ˜¯æµè§ˆå™¨æµ‹è¯•è§¦å‘äº† Vercel å®‰å…¨æ£€æŸ¥ã€‚è¯·ä½¿ç”¨ä¸Šè¿°å…¶ä»–æ–¹å¼æµ‹è¯•ã€‚** âœ…

