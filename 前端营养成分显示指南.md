# å‰ç«¯è¥å…»æˆåˆ†æ˜¾ç¤ºæŒ‡å—

## ğŸ“Š è¥å…»æˆåˆ†æ•°æ®ç»“æ„

### åç«¯è¿”å›çš„æ•°æ®æ ¼å¼

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": 4,
    "title": "çº¢çƒ§æ’éª¨",
    "servings": 4,
    "nutrition": {
      "calories": "450kcal",
      "protein": "32g",
      "fat": "28g",
      "carbs": "15g"
    }
    // ... å…¶ä»–å­—æ®µ
  }
}
```

### è¥å…»æˆåˆ†å­—æ®µè¯´æ˜

| å­—æ®µå | ä¸­æ–‡å | ç¤ºä¾‹å€¼ | è¯´æ˜ |
|--------|--------|--------|------|
| `calories` | çƒ­é‡ | `"450kcal"` | æ¯ä»½çš„çƒ­é‡ |
| `protein` | è›‹ç™½è´¨ | `"32g"` | æ¯ä»½çš„è›‹ç™½è´¨å«é‡ |
| `fat` | è„‚è‚ª | `"28g"` | æ¯ä»½çš„è„‚è‚ªå«é‡ |
| `carbs` | ç¢³æ°´åŒ–åˆç‰© | `"15g"` | æ¯ä»½çš„ç¢³æ°´åŒ–åˆç‰©å«é‡ |

## ğŸ¨ å‰ç«¯æ˜¾ç¤ºç¤ºä¾‹

### å¾®ä¿¡å°ç¨‹åº WXML

```xml
<!-- è¥å…»æˆåˆ†å¡ç‰‡ -->
<view class="nutrition-card" wx:if="{{recipe.nutrition}}">
  <view class="card-title">è¥å…»æˆåˆ†ï¼ˆæ¯ä»½ï¼‰</view>
  
  <view class="nutrition-grid">
    <!-- çƒ­é‡ -->
    <view class="nutrition-item">
      <view class="nutrition-label">çƒ­é‡</view>
      <view class="nutrition-value">{{recipe.nutrition.calories || '-'}}</view>
    </view>
    
    <!-- è›‹ç™½è´¨ -->
    <view class="nutrition-item">
      <view class="nutrition-label">è›‹ç™½è´¨</view>
      <view class="nutrition-value">{{recipe.nutrition.protein || '-'}}</view>
    </view>
    
    <!-- è„‚è‚ª -->
    <view class="nutrition-item">
      <view class="nutrition-label">è„‚è‚ª</view>
      <view class="nutrition-value">{{recipe.nutrition.fat || '-'}}</view>
    </view>
    
    <!-- ç¢³æ°´ -->
    <view class="nutrition-item">
      <view class="nutrition-label">ç¢³æ°´</view>
      <view class="nutrition-value">{{recipe.nutrition.carbs || '-'}}</view>
    </view>
  </view>
  
  <view class="nutrition-note" wx:if="{{recipe.servings}}">
    * ä»¥ä¸Šä¸º {{recipe.servings}} äººä»½çš„è¥å…»æˆåˆ†
  </view>
</view>

<!-- å¦‚æœæ²¡æœ‰è¥å…»æˆåˆ†æ•°æ®ï¼Œæ˜¾ç¤ºæç¤º -->
<view class="no-nutrition" wx:else>
  <text>æš‚æ— è¥å…»æˆåˆ†æ•°æ®</text>
</view>
```

### å¾®ä¿¡å°ç¨‹åº WXSS

```css
/* è¥å…»æˆåˆ†å¡ç‰‡æ ·å¼ */
.nutrition-card {
  background: #fff;
  border-radius: 16rpx;
  padding: 32rpx;
  margin: 24rpx 0;
  box-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.05);
}

.card-title {
  font-size: 32rpx;
  font-weight: 600;
  color: #333;
  margin-bottom: 24rpx;
}

.nutrition-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 24rpx;
}

.nutrition-item {
  background: #f8f9fa;
  border-radius: 12rpx;
  padding: 24rpx;
  text-align: center;
}

.nutrition-label {
  font-size: 24rpx;
  color: #999;
  margin-bottom: 8rpx;
}

.nutrition-value {
  font-size: 36rpx;
  font-weight: 600;
  color: #ff6b6b;
}

.nutrition-note {
  font-size: 24rpx;
  color: #999;
  margin-top: 16rpx;
  text-align: center;
}

.no-nutrition {
  padding: 48rpx;
  text-align: center;
  color: #999;
  font-size: 28rpx;
}
```

### å¾®ä¿¡å°ç¨‹åº JS

```javascript
Page({
  data: {
    recipe: null
  },

  onLoad(options) {
    const recipeId = options.id;
    this.loadRecipeDetail(recipeId);
  },

  async loadRecipeDetail(recipeId) {
    try {
      wx.showLoading({ title: 'åŠ è½½ä¸­...' });
      
      const res = await wx.request({
        url: `https://yjsp-ytg-191595-4-1367462091.sh.run.tcloudbase.com/api/v1/recipes/${recipeId}`,
        method: 'GET'
      });

      if (res.data.code === 200) {
        this.setData({
          recipe: res.data.data
        });
        
        // è°ƒè¯•ï¼šæ‰“å°è¥å…»æˆåˆ†æ•°æ®
        console.log('è¥å…»æˆåˆ†:', res.data.data.nutrition);
        
        // æ£€æŸ¥æ˜¯å¦æœ‰è¥å…»æˆåˆ†
        if (!res.data.data.nutrition) {
          console.warn('è¯¥é£Ÿè°±æ²¡æœ‰è¥å…»æˆåˆ†æ•°æ®');
        }
      } else {
        wx.showToast({
          title: 'åŠ è½½å¤±è´¥',
          icon: 'none'
        });
      }
    } catch (error) {
      console.error('åŠ è½½é£Ÿè°±è¯¦æƒ…å¤±è´¥:', error);
      wx.showToast({
        title: 'ç½‘ç»œé”™è¯¯',
        icon: 'none'
      });
    } finally {
      wx.hideLoading();
    }
  }
});
```

## ğŸ” é—®é¢˜æ’æŸ¥æ­¥éª¤

### 1. æ£€æŸ¥ API è¿”å›æ•°æ®

åœ¨å°ç¨‹åºå¼€å‘è€…å·¥å…·çš„ Console ä¸­æŸ¥çœ‹ï¼š

```javascript
// åŠ è½½é£Ÿè°±è¯¦æƒ…åï¼Œæ‰“å°å®Œæ•´æ•°æ®
console.log('é£Ÿè°±è¯¦æƒ…:', recipe);
console.log('è¥å…»æˆåˆ†:', recipe.nutrition);
```

**æœŸæœ›ç»“æœ**ï¼š
```javascript
{
  calories: "450kcal",
  protein: "32g",
  fat: "28g",
  carbs: "15g"
}
```

### 2. æ£€æŸ¥æ•°æ®ç»‘å®š

ç¡®ä¿åœ¨ WXML ä¸­æ­£ç¡®ä½¿ç”¨äº† `nutrition` å­—æ®µï¼š

```xml
<!-- âœ… æ­£ç¡® -->
<text>{{recipe.nutrition.calories}}</text>

<!-- âŒ é”™è¯¯ -->
<text>{{recipe.nutritionInfo.calories}}</text>
<text>{{recipe.nutrient.calories}}</text>
```

### 3. æ£€æŸ¥æ¡ä»¶æ¸²æŸ“

ç¡®ä¿ä½¿ç”¨äº† `wx:if` æ¥åˆ¤æ–­æ•°æ®æ˜¯å¦å­˜åœ¨ï¼š

```xml
<!-- âœ… æ­£ç¡® -->
<view wx:if="{{recipe.nutrition}}">
  {{recipe.nutrition.calories}}
</view>

<!-- âŒ é”™è¯¯ï¼ˆæ²¡æœ‰åˆ¤æ–­ï¼Œä¼šæŠ¥é”™ï¼‰ -->
<view>
  {{recipe.nutrition.calories}}
</view>
```

### 4. æ£€æŸ¥ API åœ°å€

ç¡®ä¿ä½¿ç”¨çš„æ˜¯äº‘æ‰˜ç®¡åœ°å€ï¼š

```javascript
// âœ… æ­£ç¡®ï¼ˆäº‘æ‰˜ç®¡åœ°å€ï¼‰
const API_BASE = 'https://yjsp-ytg-191595-4-1367462091.sh.run.tcloudbase.com';

// âŒ é”™è¯¯ï¼ˆæ—§åœ°å€æˆ–æœ¬åœ°åœ°å€ï¼‰
const API_BASE = 'http://localhost:3000';
```

## ğŸ“± å®Œæ•´çš„è¥å…»æˆåˆ†å±•ç¤ºç»„ä»¶

### components/nutrition-card/nutrition-card.wxml

```xml
<view class="nutrition-card" wx:if="{{nutrition}}">
  <view class="card-header">
    <view class="card-title">è¥å…»æˆåˆ†</view>
    <view class="servings-info" wx:if="{{servings}}">{{servings}}äººä»½</view>
  </view>
  
  <view class="nutrition-list">
    <view class="nutrition-row">
      <view class="nutrition-item primary">
        <text class="label">çƒ­é‡</text>
        <text class="value">{{nutrition.calories || '-'}}</text>
      </view>
    </view>
    
    <view class="nutrition-row">
      <view class="nutrition-item">
        <text class="label">è›‹ç™½è´¨</text>
        <text class="value">{{nutrition.protein || '-'}}</text>
      </view>
      
      <view class="nutrition-item">
        <text class="label">è„‚è‚ª</text>
        <text class="value">{{nutrition.fat || '-'}}</text>
      </view>
      
      <view class="nutrition-item">
        <text class="label">ç¢³æ°´</text>
        <text class="value">{{nutrition.carbs || '-'}}</text>
      </view>
    </view>
  </view>
</view>
```

### components/nutrition-card/nutrition-card.js

```javascript
Component({
  properties: {
    nutrition: {
      type: Object,
      value: null
    },
    servings: {
      type: Number,
      value: 1
    }
  }
});
```

### ä½¿ç”¨ç»„ä»¶

```xml
<!-- åœ¨é£Ÿè°±è¯¦æƒ…é¡µé¢ä¸­ä½¿ç”¨ -->
<nutrition-card 
  nutrition="{{recipe.nutrition}}" 
  servings="{{recipe.servings}}"
/>
```

## ğŸ¯ å½“å‰æ‰€æœ‰é£Ÿè°±çš„è¥å…»æˆåˆ†æ•°æ®

| é£Ÿè°±ID | æ ‡é¢˜ | çƒ­é‡ | è›‹ç™½è´¨ | è„‚è‚ª | ç¢³æ°´ | ä»½æ•° |
|--------|------|------|--------|------|------|------|
| 4 | çº¢çƒ§æ’éª¨ | 450kcal | 32g | 28g | 15g | 4äººä»½ |
| 5 | æˆšé£è›‹ç³• | 220kcal | 6g | 12g | 22g | 8äººä»½ |
| 6 | ç•ªèŒ„ç‚’è›‹ | 180kcal | 12g | 10g | 8g | 2äººä»½ |
| 7 | æŠ¹èŒ¶æ‹¿é“ | 150kcal | 7g | 5g | 20g | 1äººä»½ |
| 8 | å®«ä¿é¸¡ä¸ | 380kcal | 28g | 18g | 25g | 3äººä»½ |

## ğŸ’¡ å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆå‰ç«¯æ˜¾ç¤ºä¸å‡ºè¥å…»æˆåˆ†ï¼Ÿ
**A**: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
1. API è¯·æ±‚æ˜¯å¦æˆåŠŸï¼ˆæ£€æŸ¥ Networkï¼‰
2. æ•°æ®å­—æ®µåæ˜¯å¦æ­£ç¡®ï¼ˆ`nutrition` ä¸æ˜¯ `nutritionInfo`ï¼‰
3. æ˜¯å¦ä½¿ç”¨äº† `wx:if` æ¡ä»¶æ¸²æŸ“
4. æ˜¯å¦ä½¿ç”¨äº†äº‘æ‰˜ç®¡åœ°å€è€Œä¸æ˜¯æœ¬åœ°åœ°å€

### Q2: å¦‚ä½•åœ¨åˆ—è¡¨é¡µæ˜¾ç¤ºçƒ­é‡ï¼Ÿ
**A**: 
```xml
<text>{{item.nutrition ? item.nutrition.calories : 'æœªçŸ¥'}}</text>
```

### Q3: è¥å…»æˆåˆ†æ•°æ®æ˜¯æ¯ä»½è¿˜æ˜¯æ€»é‡ï¼Ÿ
**A**: åç«¯è¿”å›çš„æ˜¯ **æ¯ä»½** çš„è¥å…»æˆåˆ†ï¼Œè¯·é…åˆ `servings` å­—æ®µæ˜¾ç¤ºæ€»ä»½æ•°ã€‚

---

**å¦‚æœå‰ç«¯è¿˜æ˜¯çœ‹ä¸åˆ°è¥å…»æˆåˆ†ï¼Œè¯·æä¾›å‰ç«¯ä»£ç çš„æˆªå›¾æˆ–ä»£ç ç‰‡æ®µï¼Œæˆ‘å¯ä»¥å¸®ä½ å®šä½é—®é¢˜ï¼** ğŸ”

