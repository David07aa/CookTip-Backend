# CookTip åç«¯éƒ¨ç½²ä¿¡æ¯

## ğŸŒ ç”Ÿäº§ç¯å¢ƒ

### äº‘æ‰˜ç®¡åœ°å€
```
https://rnvvjhwh.yjsp-ytg.0er4gbxk.1tj8lj27.com
```

### API åŸºç¡€è·¯å¾„
```
https://rnvvjhwh.yjsp-ytg.0er4gbxk.1tj8lj27.com/api/v1
```

### Swagger API æ–‡æ¡£
```
https://rnvvjhwh.yjsp-ytg.0er4gbxk.1tj8lj27.com/api/docs
```

---

## ğŸ“‹ API æ¥å£åˆ—è¡¨

### è®¤è¯æ¨¡å—
- **å¾®ä¿¡ç™»å½•**: `POST /api/v1/auth/wx-login`
- **åˆ·æ–° Token**: `POST /api/v1/auth/refresh`
- **é€€å‡ºç™»å½•**: `POST /api/v1/auth/logout`

### ç”¨æˆ·æ¨¡å—
- **è·å–ç”¨æˆ·ä¿¡æ¯**: `GET /api/v1/user/profile`
- **æ›´æ–°ç”¨æˆ·ä¿¡æ¯**: `PUT /api/v1/user/profile`
- **è·å–ç”¨æˆ·é£Ÿè°±**: `GET /api/v1/user/recipes`
- **è·å–ç”¨æˆ·æ”¶è—**: `GET /api/v1/user/favorites`

### é£Ÿè°±æ¨¡å—
- **é£Ÿè°±åˆ—è¡¨**: `GET /api/v1/recipes`
- **åˆ›å»ºé£Ÿè°±**: `POST /api/v1/recipes`
- **é£Ÿè°±è¯¦æƒ…**: `GET /api/v1/recipes/:id`
- **æ›´æ–°é£Ÿè°±**: `PUT /api/v1/recipes/:id`
- **åˆ é™¤é£Ÿè°±**: `DELETE /api/v1/recipes/:id`
- **ç‚¹èµé£Ÿè°±**: `POST /api/v1/recipes/:id/like`
- **å–æ¶ˆç‚¹èµ**: `DELETE /api/v1/recipes/:id/like`

### è¯„è®ºæ¨¡å—
- **è·å–è¯„è®º**: `GET /api/v1/comments/recipe/:recipeId`
- **åˆ›å»ºè¯„è®º**: `POST /api/v1/comments`
- **åˆ é™¤è¯„è®º**: `DELETE /api/v1/comments/:id`

### æ”¶è—æ¨¡å—
- **æ”¶è—é£Ÿè°±**: `POST /api/v1/favorites`
- **å–æ¶ˆæ”¶è—**: `DELETE /api/v1/favorites/:recipeId`
- **æˆ‘çš„æ”¶è—**: `GET /api/v1/favorites`

### æœç´¢æ¨¡å—
- **æœç´¢é£Ÿè°±**: `GET /api/v1/search?keyword=xxx`
- **çƒ­é—¨æœç´¢**: `GET /api/v1/search/hot`

### è´­ç‰©æ¸…å•æ¨¡å—
- **è´­ç‰©æ¸…å•**: `GET /api/v1/shopping-list`
- **æ·»åŠ è´­ç‰©é¡¹**: `POST /api/v1/shopping-list`
- **æ›´æ–°è´­ç‰©é¡¹**: `PUT /api/v1/shopping-list/:id`
- **åˆ é™¤è´­ç‰©é¡¹**: `DELETE /api/v1/shopping-list/:id`

### åˆ†ç±»æ¨¡å—
- **åˆ†ç±»åˆ—è¡¨**: `GET /api/v1/categories`
- **åˆ†ç±»ä¸‹çš„é£Ÿè°±**: `GET /api/v1/categories/:id/recipes`

### æ–‡ä»¶ä¸Šä¼ æ¨¡å—
- **ä¸Šä¼ å›¾ç‰‡**: `POST /api/v1/upload/image`

### ç»Ÿè®¡æ¨¡å—
- **é¦–é¡µç»Ÿè®¡**: `GET /api/v1/stats/overview`
- **æ¨èé£Ÿè°±**: `GET /api/v1/stats/recommended`

---

## ğŸ”§ å°ç¨‹åºé…ç½®

### åœ¨å°ç¨‹åºä¸­é…ç½® API åœ°å€

**config.js:**
```javascript
// ç”Ÿäº§ç¯å¢ƒé…ç½®
const production = {
  apiBaseUrl: 'https://rnvvjhwh.yjsp-ytg.0er4gbxk.1tj8lj27.com/api/v1',
  uploadUrl: 'https://rnvvjhwh.yjsp-ytg.0er4gbxk.1tj8lj27.com/api/v1/upload/image',
};

// å¼€å‘ç¯å¢ƒé…ç½®
const development = {
  apiBaseUrl: 'http://localhost:3000/api/v1',
  uploadUrl: 'http://localhost:3000/api/v1/upload/image',
};

// å¯¼å‡ºé…ç½®
module.exports = process.env.NODE_ENV === 'production' ? production : development;
```

### ä½¿ç”¨ç¤ºä¾‹

**ç™»å½•:**
```javascript
const config = require('./config');

wx.login({
  success: (res) => {
    if (res.code) {
      wx.request({
        url: `${config.apiBaseUrl}/auth/wx-login`,
        method: 'POST',
        data: { code: res.code },
        success: (response) => {
          const { token } = response.data.data;
          wx.setStorageSync('token', token);
        }
      });
    }
  }
});
```

**è·å–é£Ÿè°±åˆ—è¡¨:**
```javascript
wx.request({
  url: `${config.apiBaseUrl}/recipes`,
  method: 'GET',
  header: {
    'Authorization': `Bearer ${wx.getStorageSync('token')}`
  },
  data: {
    page: 1,
    limit: 10
  },
  success: (res) => {
    console.log(res.data.data);
  }
});
```

**ä¸Šä¼ å›¾ç‰‡:**
```javascript
wx.chooseImage({
  count: 1,
  success: (res) => {
    const tempFilePath = res.tempFilePaths[0];
    wx.uploadFile({
      url: config.uploadUrl,
      filePath: tempFilePath,
      name: 'file',
      header: {
        'Authorization': `Bearer ${wx.getStorageSync('token')}`
      },
      success: (uploadRes) => {
        const data = JSON.parse(uploadRes.data);
        console.log('å›¾ç‰‡URL:', data.data.url);
      }
    });
  }
});
```

---

## ğŸ“Š å¿«é€Ÿæµ‹è¯•

### 1. æµ‹è¯•å¥åº·æ£€æŸ¥
```bash
curl https://rnvvjhwh.yjsp-ytg.0er4gbxk.1tj8lj27.com/
```

### 2. è®¿é—® API æ–‡æ¡£
æµè§ˆå™¨æ‰“å¼€ï¼š
```
https://rnvvjhwh.yjsp-ytg.0er4gbxk.1tj8lj27.com/api/docs
```

### 3. æµ‹è¯•åˆ†ç±»æ¥å£
```bash
curl https://rnvvjhwh.yjsp-ytg.0er4gbxk.1tj8lj27.com/api/v1/categories
```

### 4. æµ‹è¯•å¾®ä¿¡ç™»å½•ï¼ˆéœ€è¦çœŸå® codeï¼‰
```bash
curl -X POST https://rnvvjhwh.yjsp-ytg.0er4gbxk.1tj8lj27.com/api/v1/auth/wx-login \
  -H "Content-Type: application/json" \
  -d '{"code":"your-wx-code"}'
```

---

## ğŸ” ç¯å¢ƒå˜é‡

å½“å‰ç”Ÿäº§ç¯å¢ƒé…ç½®ï¼š

```
DB_TYPE=mysql
DB_HOST=mysql3.sqlpub.com
DB_PORT=3308
DB_USERNAME=david_x
DB_DATABASE=onefoodlibrary
JWT_EXPIRES_IN=7d
WX_APPID=wx8486e57500ac0a55
PORT=3000
NODE_ENV=production
THROTTLE_TTL=60
THROTTLE_LIMIT=10
```

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **å°ç¨‹åºé…ç½®æœåŠ¡å™¨åŸŸå**
   - ç™»å½•å¾®ä¿¡å…¬ä¼—å¹³å°ï¼šhttps://mp.weixin.qq.com
   - å¼€å‘ â†’ å¼€å‘ç®¡ç† â†’ å¼€å‘è®¾ç½® â†’ æœåŠ¡å™¨åŸŸå
   - æ·»åŠ ä»¥ä¸‹åŸŸååˆ° request åˆæ³•åŸŸåï¼š
     ```
     https://rnvvjhwh.yjsp-ytg.0er4gbxk.1tj8lj27.com
     ```
   - æ·»åŠ ä»¥ä¸‹åŸŸååˆ° uploadFile åˆæ³•åŸŸåï¼š
     ```
     https://rnvvjhwh.yjsp-ytg.0er4gbxk.1tj8lj27.com
     ```

2. **HTTPS è®¿é—®**
   - äº‘æ‰˜ç®¡å·²è‡ªåŠ¨é…ç½® HTTPS
   - å°ç¨‹åºå¿…é¡»ä½¿ç”¨ HTTPS åè®®

3. **è·¨åŸŸé…ç½®**
   - åç«¯å·²å¯ç”¨ CORSï¼Œå…è®¸æ‰€æœ‰æ¥æº
   - ç”Ÿäº§ç¯å¢ƒå»ºè®®é™åˆ¶ç‰¹å®šåŸŸå

---

## ğŸš€ éƒ¨ç½²ä¿¡æ¯

- **éƒ¨ç½²æ—¶é—´**: 2025-10-08
- **éƒ¨ç½²æ–¹å¼**: å¾®ä¿¡äº‘æ‰˜ç®¡
- **ä»£ç ä»“åº“**: https://github.com/David07aa/CookTip-Backend
- **è¿è¡Œç¯å¢ƒ**: Node.js 18 + Nest.js
- **æ•°æ®åº“**: SQLPub MySQL 8.4.3

---

**æ›´æ–°æ—¶é—´**: 2025-10-08

