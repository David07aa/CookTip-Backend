# ğŸ‰ CookTip åç«¯ API å‰ç«¯å¯¹æ¥æ–‡æ¡£

## ğŸ“Š é¡¹ç›®çŠ¶æ€

âœ… **åç«¯éƒ¨ç½²å®Œæˆ**  
âœ… **æ•°æ®åº“è¿ç§»å®Œæˆ** (MySQL â†’ PostgreSQL)  
âœ… **è€ä¹¡é¸¡èœè°±å¯¼å…¥å®Œæˆ** (198ä¸ªèœè°±)  
âœ… **API æ¥å£æµ‹è¯•é€šè¿‡**  
âœ… **å‡†å¤‡å‰ç«¯å¯¹æ¥**

---

## ğŸŒ API åŸºç¡€ä¿¡æ¯

**Base URLï¼š** `https://cooktip-backend.vercel.app`  
**æ•°æ®åº“ï¼š** Vercel Postgres (Neon)  
**æ•°æ®æ€»é‡ï¼š** 198 ä¸ªè€ä¹¡é¸¡ç»å…¸èœè°±  
**è®¤è¯æ–¹å¼ï¼š** JWT (éƒ¨åˆ†æ¥å£éœ€è¦)

---

## ğŸ“¡ æ ¸å¿ƒ API æ¥å£

### 1. é£Ÿè°±ç›¸å…³

#### è·å–é£Ÿè°±åˆ—è¡¨
```http
GET /api/recipes?page=1&limit=10
```

**æŸ¥è¯¢å‚æ•°ï¼š**
- `page` (å¯é€‰): é¡µç ï¼Œé»˜è®¤1
- `limit` (å¯é€‰): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤10
- `category` (å¯é€‰): åˆ†ç±»ç­›é€‰
- `difficulty` (å¯é€‰): éš¾åº¦ç­›é€‰ (ç®€å•/ä¸­ç­‰/å›°éš¾)
- `health` (å¯é€‰): health=check ç”¨äºå¥åº·æ£€æŸ¥

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "code": 200,
  "message": "è·å–æˆåŠŸ",
  "data": {
    "list": [
      {
        "id": "uuid",
        "title": "å®«ä¿é¸¡ä¸",
        "category": "ç‚’èœ",
        "difficulty": "ä¸­ç­‰",
        "cookTime": 30,
        "coverImage": "url",
        "introduction": "ç»å…¸å·èœ...",
        "likes": 0,
        "collects": 0,
        "viewCount": 0
      }
    ],
    "pagination": {
      "total": 198,
      "page": 1,
      "pageSize": 10,
      "pages": 20
    }
  }
}
```

#### è·å–é£Ÿè°±è¯¦æƒ…
```http
GET /api/recipes/{id}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "code": 200,
  "data": {
    "id": "uuid",
    "title": "å®«ä¿é¸¡ä¸",
    "introduction": "ç»å…¸å·èœ...",
    "category": "ç‚’èœ",
    "difficulty": "ä¸­ç­‰",
    "cookTime": 30,
    "ingredients": [
      {
        "name": "é¸¡èƒ¸è‚‰",
        "amount": "200g"
      }
    ],
    "steps": [
      {
        "order": 1,
        "content": "é¸¡èƒ¸è‚‰åˆ‡ä¸...",
        "image": "url"
      }
    ],
    "nutrition": {
      "calories": "350kcal",
      "protein": "25g"
    },
    "tips": "å°è´´å£«å†…å®¹",
    "likes": 0,
    "collects": 0,
    "viewCount": 0
  }
}
```

---

### 2. æœç´¢æ¥å£

#### æœç´¢é£Ÿè°±
```http
GET /api/search?keyword=é¸¡&page=1&pageSize=10
```

**æŸ¥è¯¢å‚æ•°ï¼š**
- `keyword` (å¿…éœ€): æœç´¢å…³é”®è¯
- `page` (å¯é€‰): é¡µç 
- `pageSize` (å¯é€‰): æ¯é¡µæ•°é‡

**å“åº”æ ¼å¼ï¼š** ä¸é£Ÿè°±åˆ—è¡¨ç›¸åŒ

---

### 3. åˆ†ç±»æ¥å£

#### è·å–æ‰€æœ‰åˆ†ç±»
```http
GET /api/categories
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "code": 200,
  "data": [
    "ç‚’èœ",
    "å‡‰èœ",
    "æ±¤",
    "ä¸»é£Ÿ",
    "å°åƒ",
    "ç”œå“"
  ]
}
```

---

### 4. ç”¨æˆ·ç›¸å…³ (éœ€è¦è®¤è¯)

#### å¾®ä¿¡ç™»å½•
```http
POST /api/auth/login
Content-Type: application/json

{
  "code": "å¾®ä¿¡ç™»å½•code"
}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "code": 200,
  "data": {
    "token": "jwt-token",
    "user": {
      "id": "uuid",
      "nickName": "ç”¨æˆ·æ˜µç§°",
      "avatar": "å¤´åƒURL"
    }
  }
}
```

#### è·å–ç”¨æˆ·ä¿¡æ¯
```http
GET /api/user/info
Authorization: Bearer {token}
```

---

### 5. æ”¶è—ç›¸å…³ (éœ€è¦è®¤è¯)

#### è·å–æ”¶è—åˆ—è¡¨
```http
GET /api/favorites?page=1&limit=10
Authorization: Bearer {token}
```

#### æ·»åŠ /å–æ¶ˆæ”¶è—
```http
POST /api/favorites
Authorization: Bearer {token}
Content-Type: application/json

{
  "recipeId": "uuid"
}
```

---

### 6. ç‚¹èµç›¸å…³ (éœ€è¦è®¤è¯)

#### ç‚¹èµ/å–æ¶ˆç‚¹èµ
```http
POST /api/likes
Authorization: Bearer {token}
Content-Type: application/json

{
  "recipeId": "uuid"
}
```

---

### 7. è¯„è®ºç›¸å…³ (éœ€è¦è®¤è¯)

#### è·å–è¯„è®ºåˆ—è¡¨
```http
GET /api/comments?recipeId={id}&page=1&limit=10
```

#### æ·»åŠ è¯„è®º
```http
POST /api/comments
Authorization: Bearer {token}
Content-Type: application/json

{
  "recipeId": "uuid",
  "content": "è¯„è®ºå†…å®¹",
  "rating": 5,
  "images": ["url1", "url2"]
}
```

---

## ğŸ” è®¤è¯è¯´æ˜

éœ€è¦è®¤è¯çš„æ¥å£éœ€è¦åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  JWT tokenï¼š

```javascript
fetch('https://cooktip-backend.vercel.app/api/user/info', {
  headers: {
    'Authorization': 'Bearer ' + token,
    'Content-Type': 'application/json'
  }
})
```

---

## ğŸ’» å‰ç«¯ç¤ºä¾‹ä»£ç 

### Vue 3 ç¤ºä¾‹

```javascript
// api/recipes.js
import axios from 'axios'

const BASE_URL = 'https://cooktip-backend.vercel.app'

// è·å–é£Ÿè°±åˆ—è¡¨
export const getRecipes = (params) => {
  return axios.get(`${BASE_URL}/api/recipes`, { params })
}

// è·å–é£Ÿè°±è¯¦æƒ…
export const getRecipeDetail = (id) => {
  return axios.get(`${BASE_URL}/api/recipes/${id}`)
}

// æœç´¢é£Ÿè°±
export const searchRecipes = (keyword, page = 1) => {
  return axios.get(`${BASE_URL}/api/search`, {
    params: { keyword, page, pageSize: 10 }
  })
}

// ä½¿ç”¨ç¤ºä¾‹
async function loadRecipes() {
  try {
    const response = await getRecipes({ page: 1, limit: 10 })
    console.log('é£Ÿè°±åˆ—è¡¨:', response.data.data.list)
  } catch (error) {
    console.error('è·å–å¤±è´¥:', error)
  }
}
```

### å¾®ä¿¡å°ç¨‹åºç¤ºä¾‹

```javascript
// utils/api.js
const BASE_URL = 'https://cooktip-backend.vercel.app'

// è·å–é£Ÿè°±åˆ—è¡¨
export function getRecipes(params) {
  return new Promise((resolve, reject) => {
    wx.request({
      url: `${BASE_URL}/api/recipes`,
      data: params,
      success: (res) => resolve(res.data),
      fail: reject
    })
  })
}

// ä½¿ç”¨ç¤ºä¾‹
async function loadRecipes() {
  try {
    const data = await getRecipes({ page: 1, limit: 10 })
    console.log('é£Ÿè°±æ€»æ•°:', data.data.pagination.total)
    console.log('é£Ÿè°±åˆ—è¡¨:', data.data.list)
  } catch (error) {
    console.error('è·å–å¤±è´¥:', error)
  }
}
```

---

## ğŸ¨ æ•°æ®å­—æ®µè¯´æ˜

### é£Ÿè°±å¯¹è±¡ (Recipe)

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|-----|------|------|
| `id` | string | UUID |
| `title` | string | èœè°±æ ‡é¢˜ |
| `introduction` | string | èœè°±ç®€ä»‹ |
| `category` | string | åˆ†ç±» |
| `difficulty` | string | éš¾åº¦ (ç®€å•/ä¸­ç­‰/å›°éš¾) |
| `cookTime` | number | çƒ¹é¥ªæ—¶é—´(åˆ†é’Ÿ) |
| `coverImage` | string | å°é¢å›¾URL |
| `ingredients` | array | åŸæ–™åˆ—è¡¨ |
| `steps` | array | æ­¥éª¤åˆ—è¡¨ |
| `nutrition` | object | è¥å…»ä¿¡æ¯ |
| `tips` | string | å°è´´å£« |
| `likes` | number | ç‚¹èµæ•° |
| `collects` | number | æ”¶è—æ•° |
| `viewCount` | number | æµè§ˆæ¬¡æ•° |

### åŸæ–™å¯¹è±¡ (Ingredient)

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|-----|------|------|
| `name` | string | åŸæ–™åç§° |
| `amount` | string | ç”¨é‡ |
| `note` | string | å¤‡æ³¨ (å¯é€‰) |

### æ­¥éª¤å¯¹è±¡ (Step)

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|-----|------|------|
| `order` | number | æ­¥éª¤åºå· |
| `content` | string | æ­¥éª¤å†…å®¹ |
| `image` | string | æ­¥éª¤å›¾ç‰‡ (å¯é€‰) |
| `time` | number | æ‰€éœ€æ—¶é—´(åˆ†é’Ÿ, å¯é€‰) |

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### é€Ÿç‡é™åˆ¶
- Vercel Hobby è®¡åˆ’æœ‰é€Ÿç‡é™åˆ¶
- å»ºè®®å‰ç«¯æ·»åŠ é˜²æŠ–/èŠ‚æµ
- é¿å…çŸ­æ—¶é—´å†…å¤§é‡è¯·æ±‚

### CORS
- å·²é…ç½®è·¨åŸŸæ”¯æŒ
- æ”¯æŒæ‰€æœ‰æ¥æºçš„è¯·æ±‚

### é”™è¯¯å¤„ç†
```javascript
// ç»Ÿä¸€é”™è¯¯å¤„ç†ç¤ºä¾‹
axios.interceptors.response.use(
  response => response,
  error => {
    if (error.response) {
      switch (error.response.status) {
        case 401:
          // æœªæˆæƒï¼Œè·³è½¬ç™»å½•
          break
        case 404:
          // èµ„æºä¸å­˜åœ¨
          break
        case 429:
          // è¯·æ±‚è¿‡äºé¢‘ç¹
          console.warn('è¯·æ±‚è¿‡äºé¢‘ç¹ï¼Œè¯·ç¨åå†è¯•')
          break
        case 500:
          // æœåŠ¡å™¨é”™è¯¯
          break
      }
    }
    return Promise.reject(error)
  }
)
```

---

## ğŸ“ TODO æ¸…å•

å‰ç«¯å¼€å‘å»ºè®®æ­¥éª¤ï¼š

- [ ] 1. é…ç½® API åŸºç¡€URLå’Œè¯·æ±‚æ‹¦æˆªå™¨
- [ ] 2. å®ç°é£Ÿè°±åˆ—è¡¨é¡µé¢
- [ ] 3. å®ç°é£Ÿè°±è¯¦æƒ…é¡µé¢
- [ ] 4. å®ç°æœç´¢åŠŸèƒ½
- [ ] 5. å®ç°åˆ†ç±»ç­›é€‰
- [ ] 6. å®ç°å¾®ä¿¡ç™»å½•
- [ ] 7. å®ç°æ”¶è—åŠŸèƒ½
- [ ] 8. å®ç°ç‚¹èµåŠŸèƒ½
- [ ] 9. å®ç°è¯„è®ºåŠŸèƒ½
- [ ] 10. æ€§èƒ½ä¼˜åŒ–å’Œé”™è¯¯å¤„ç†

---

## ğŸš€ å¿«é€Ÿæµ‹è¯•

**å¥åº·æ£€æŸ¥ï¼š**
```bash
curl https://cooktip-backend.vercel.app/api/recipes?health=check
```

**è·å–é£Ÿè°±åˆ—è¡¨ï¼š**
```bash
curl https://cooktip-backend.vercel.app/api/recipes?page=1&limit=5
```

**æœç´¢é£Ÿè°±ï¼š**
```bash
curl "https://cooktip-backend.vercel.app/api/search?keyword=é¸¡"
```

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

- **APIæ–‡æ¡£ç‰ˆæœ¬ï¼š** v1.0
- **æœ€åæ›´æ–°ï¼š** 2025-10-02
- **èœè°±æ•°æ®æ¥æºï¼š** è€ä¹¡é¸¡å®˜æ–¹èœè°± (198ä¸ª)

---

## ğŸ‰ åç»­è®¡åˆ’

1. âœ… åç«¯APIéƒ¨ç½²
2. âœ… æ•°æ®åº“è¿ç§»å’Œä¼˜åŒ–
3. âœ… è€ä¹¡é¸¡èœè°±å¯¼å…¥
4. ğŸ”„ å‰ç«¯å¼€å‘å¯¹æ¥ (è¿›è¡Œä¸­)
5. â³ ç”¨æˆ·æµ‹è¯•å’Œåé¦ˆ
6. â³ æ€§èƒ½ä¼˜åŒ–å’Œæ‰©å±•

---

**ç¥å¼€å‘é¡ºåˆ©ï¼** ğŸš€

