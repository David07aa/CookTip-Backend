# CookTip åç«¯é¡¹ç›®å¼€å‘æ€»ç»“

## ğŸ‰ é¡¹ç›®å®Œæˆæƒ…å†µ

**å¼€å‘çŠ¶æ€**: âœ… å…¨éƒ¨å®Œæˆ  
**å¼€å‘æ—¶é—´**: 2025-01-08  
**é¡¹ç›®ç‰ˆæœ¬**: v1.0.0

---

## âœ¨ å·²å®ŒæˆåŠŸèƒ½æ¸…å•

### Phase 1: æ ¸å¿ƒåŸºç¡€åŠŸèƒ½ âœ…

- âœ… **é¡¹ç›®æ¶æ„æ­å»º**
  - Nest.js + TypeScript æ¡†æ¶é…ç½®
  - TypeORM + MySQL æ•°æ®åº“é›†æˆ
  - Swagger API æ–‡æ¡£é›†æˆ
  - å…¨å±€æ‹¦æˆªå™¨ã€è¿‡æ»¤å™¨ã€å®ˆå«é…ç½®
  - Docker å®¹å™¨åŒ–æ”¯æŒ

- âœ… **æ•°æ®åº“è®¾è®¡**ï¼ˆ7å¼ è¡¨ï¼‰
  - `users` - ç”¨æˆ·è¡¨
  - `recipes` - é£Ÿè°±è¡¨
  - `comments` - è¯„è®ºè¡¨
  - `favorites` - æ”¶è—è¡¨
  - `likes` - ç‚¹èµè¡¨
  - `shopping_list` - è´­ç‰©æ¸…å•è¡¨
  - `categories` - åˆ†ç±»è¡¨

- âœ… **è®¤è¯æ¨¡å—**ï¼ˆ3ä¸ªæ¥å£ï¼‰
  - POST `/api/v1/auth/wechat-login` - å¾®ä¿¡ç™»å½•
  - POST `/api/v1/auth/refresh` - åˆ·æ–°Token
  - POST `/api/v1/auth/logout` - é€€å‡ºç™»å½•

- âœ… **ç”¨æˆ·æ¨¡å—**ï¼ˆ5ä¸ªæ¥å£ï¼‰
  - GET `/api/v1/users/me` - è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
  - PATCH `/api/v1/users/me` - æ›´æ–°ç”¨æˆ·ä¿¡æ¯
  - GET `/api/v1/users/:userId/recipes` - è·å–ç”¨æˆ·é£Ÿè°±åˆ—è¡¨
  - GET `/api/v1/users/me/favorites` - è·å–ç”¨æˆ·æ”¶è—åˆ—è¡¨
  - GET `/api/v1/users/:userId/stats` - è·å–ç”¨æˆ·ç»Ÿè®¡æ•°æ®

- âœ… **é£Ÿè°±æ¨¡å—**ï¼ˆ8ä¸ªæ¥å£ï¼‰
  - GET `/api/v1/recipes` - è·å–é£Ÿè°±åˆ—è¡¨
  - GET `/api/v1/recipes/:id` - è·å–é£Ÿè°±è¯¦æƒ…
  - POST `/api/v1/recipes` - åˆ›å»ºé£Ÿè°±
  - PATCH `/api/v1/recipes/:id` - æ›´æ–°é£Ÿè°±
  - DELETE `/api/v1/recipes/:id` - åˆ é™¤é£Ÿè°±
  - POST `/api/v1/recipes/:id/like` - ç‚¹èµ/å–æ¶ˆç‚¹èµ
  - POST `/api/v1/recipes/:id/favorite` - æ”¶è—/å–æ¶ˆæ”¶è—
  - POST `/api/v1/recipes/:id/view` - å¢åŠ æµè§ˆé‡

- âœ… **æ–‡ä»¶ä¸Šä¼ æ¨¡å—**ï¼ˆ2ä¸ªæ¥å£ï¼‰
  - POST `/api/v1/upload/image` - ä¸Šä¼ å•å¼ å›¾ç‰‡
  - POST `/api/v1/upload/images` - æ‰¹é‡ä¸Šä¼ å›¾ç‰‡

### Phase 2: ç¤¾äº¤åŠŸèƒ½ âœ…

- âœ… **è¯„è®ºæ¨¡å—**ï¼ˆ5ä¸ªæ¥å£ï¼‰
  - GET `/api/v1/recipes/:recipeId/comments` - è·å–é£Ÿè°±è¯„è®ºåˆ—è¡¨
  - POST `/api/v1/recipes/:recipeId/comments` - å‘è¡¨è¯„è®º
  - DELETE `/api/v1/comments/:id` - åˆ é™¤è¯„è®º
  - POST `/api/v1/comments/:id/like` - ç‚¹èµ/å–æ¶ˆç‚¹èµè¯„è®º
  - POST `/api/v1/comments/:id/reply` - å›å¤è¯„è®º

- âœ… **æ”¶è—æ¨¡å—**ï¼ˆ4ä¸ªæ¥å£ï¼‰
  - GET `/api/v1/favorites` - è·å–æ”¶è—åˆ—è¡¨
  - POST `/api/v1/favorites` - æ·»åŠ æ”¶è—ï¼ˆå·²æ•´åˆåˆ°é£Ÿè°±æ¨¡å—ï¼‰
  - DELETE `/api/v1/favorites/:recipeId` - å–æ¶ˆæ”¶è—ï¼ˆå·²æ•´åˆåˆ°é£Ÿè°±æ¨¡å—ï¼‰
  - POST `/api/v1/favorites/check` - æ‰¹é‡æ£€æŸ¥æ”¶è—çŠ¶æ€

- âœ… **æœç´¢æ¨¡å—**ï¼ˆ3ä¸ªæ¥å£ï¼‰
  - GET `/api/v1/search/recipes` - æœç´¢é£Ÿè°±
  - GET `/api/v1/search/hot-keywords` - è·å–çƒ­é—¨æœç´¢è¯
  - GET `/api/v1/search/suggestions` - è·å–æœç´¢å»ºè®®

### Phase 3: è¾…åŠ©åŠŸèƒ½ âœ…

- âœ… **è´­ç‰©æ¸…å•æ¨¡å—**ï¼ˆ5ä¸ªæ¥å£ï¼‰
  - GET `/api/v1/shopping-list` - è·å–è´­ç‰©æ¸…å•
  - POST `/api/v1/shopping-list` - æ·»åŠ è´­ç‰©æ¸…å•é¡¹
  - PATCH `/api/v1/shopping-list/:id` - æ›´æ–°è´­ç‰©æ¸…å•é¡¹
  - DELETE `/api/v1/shopping-list` - åˆ é™¤è´­ç‰©æ¸…å•é¡¹
  - DELETE `/api/v1/shopping-list/checked` - æ¸…ç©ºå·²å‹¾é€‰é¡¹

- âœ… **åˆ†ç±»æ¨¡å—**ï¼ˆ2ä¸ªæ¥å£ï¼‰
  - GET `/api/v1/categories` - è·å–åˆ†ç±»åˆ—è¡¨
  - GET `/api/v1/categories/:id` - è·å–åˆ†ç±»è¯¦æƒ…

- âœ… **ç»Ÿè®¡æ¨¡å—**ï¼ˆ3ä¸ªæ¥å£ï¼‰
  - GET `/api/v1/home/feed` - è·å–é¦–é¡µæ¨èæ•°æ®
  - GET `/api/v1/stats/hot-recipes` - è·å–çƒ­é—¨é£Ÿè°±
  - GET `/api/v1/stats/overview` - è·å–å¹³å°ç»Ÿè®¡æ•°æ®

### Phase 4: å®Œå–„å’Œéƒ¨ç½² âœ…

- âœ… **é€šç”¨åŠŸèƒ½**
  - ç»Ÿä¸€å“åº”æ‹¦æˆªå™¨
  - å…¨å±€å¼‚å¸¸è¿‡æ»¤å™¨
  - JWT è®¤è¯å®ˆå«
  - å‚æ•°éªŒè¯ç®¡é“
  - API é™æµä¿æŠ¤

- âœ… **æ–‡æ¡£å’Œéƒ¨ç½²**
  - Swagger API è‡ªåŠ¨æ–‡æ¡£
  - é¡¹ç›®è¯´æ˜.md ä½¿ç”¨æ–‡æ¡£
  - éƒ¨ç½²æŒ‡å—.md éƒ¨ç½²æ–‡æ¡£
  - æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
  - æµ‹è¯•æ•°æ®è„šæœ¬
  - Docker é…ç½®æ–‡ä»¶
  - éƒ¨ç½²è„šæœ¬

---

## ğŸ“Š é¡¹ç›®ç»Ÿè®¡

| é¡¹ç›® | æ•°é‡ |
|------|------|
| **API æ¥å£æ€»æ•°** | **40ä¸ª** |
| **ä¸šåŠ¡æ¨¡å—** | 10ä¸ª |
| **æ•°æ®è¡¨** | 7å¼  |
| **DTOç±»** | 15+ |
| **Entityå®ä½“ç±»** | 7ä¸ª |
| **ServiceæœåŠ¡ç±»** | 10ä¸ª |
| **Controlleræ§åˆ¶å™¨** | 10ä¸ª |
| **ä»£ç æ–‡ä»¶** | 80+ |

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### åç«¯æŠ€æœ¯æ ˆ

```
åç«¯æ¡†æ¶ï¼šNest.js 10.x (Node.js 18 + TypeScript 5)
æ•°æ®åº“ï¼šå¾®ä¿¡äº‘æ‰˜ç®¡ MySQL 5.7
ORMï¼šTypeORM 0.3.x
è®¤è¯ï¼šJWT + Passport
æ–‡æ¡£ï¼šSwagger 7.x
éªŒè¯ï¼šclass-validator
è½¬æ¢ï¼šclass-transformer
éƒ¨ç½²ï¼šå¾®ä¿¡äº‘æ‰˜ç®¡ + Docker
```

### é¡¹ç›®ç»“æ„

```
cooktip-backend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ common/                 # å…¬å…±æ¨¡å—
â”‚   â”œâ”€â”€ entities/               # æ•°æ®åº“å®ä½“ï¼ˆ7ä¸ªï¼‰
â”‚   â”œâ”€â”€ modules/                # ä¸šåŠ¡æ¨¡å—ï¼ˆ10ä¸ªï¼‰
â”‚   â”‚   â”œâ”€â”€ auth/              # è®¤è¯æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ user/              # ç”¨æˆ·æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ recipe/            # é£Ÿè°±æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ comment/           # è¯„è®ºæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ favorite/          # æ”¶è—æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ search/            # æœç´¢æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ shopping-list/     # è´­ç‰©æ¸…å•æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ category/          # åˆ†ç±»æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ upload/            # æ–‡ä»¶ä¸Šä¼ æ¨¡å—
â”‚   â”‚   â””â”€â”€ stats/             # ç»Ÿè®¡æ¨¡å—
â”‚   â”œâ”€â”€ app.module.ts          # åº”ç”¨æ¨¡å—
â”‚   â””â”€â”€ main.ts                # å…¥å£æ–‡ä»¶
â”œâ”€â”€ database/                   # æ•°æ®åº“è„šæœ¬
â”œâ”€â”€ scripts/                    # éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ uploads/                    # ä¸Šä¼ æ–‡ä»¶ç›®å½•
â”œâ”€â”€ Dockerfile                  # Dockeré…ç½®
â”œâ”€â”€ docker-compose.yml          # Docker Composeé…ç½®
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ é¡¹ç›®è¯´æ˜.md
```

---

## ğŸš€ å¿«é€Ÿå¯åŠ¨

### 1. å®‰è£…ä¾èµ–

```bash
npm install
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

å¤åˆ¶ `.env.example` ä¸º `.env` å¹¶å¡«å…¥é…ç½®ï¼š

```bash
cp .env.example .env
```

### 3. åˆå§‹åŒ–æ•°æ®åº“

```bash
mysql -h <host> -u <user> -p <database> < database/init.sql
```

### 4. å¯åŠ¨å¼€å‘æœåŠ¡

```bash
npm run start:dev
```

### 5. è®¿é—®æœåŠ¡

- APIåœ°å€: http://localhost:3000
- APIæ–‡æ¡£: http://localhost:3000/api/docs

---

## ğŸ“– æ ¸å¿ƒåŠŸèƒ½è¯´æ˜

### 1. å¾®ä¿¡å°ç¨‹åºç™»å½•

ä½¿ç”¨å¾®ä¿¡å°ç¨‹åºçš„ `wx.login()` è·å– codeï¼Œè°ƒç”¨åç«¯æ¥å£æ¢å–ç”¨æˆ·ä¿¡æ¯å’Œ JWT Tokenã€‚

### 2. JWT è®¤è¯

æ‰€æœ‰éœ€è¦è®¤è¯çš„æ¥å£éƒ½ä½¿ç”¨ JWT Tokenï¼ŒToken æœ‰æ•ˆæœŸ 7 å¤©ã€‚

### 3. é£Ÿè°±ç®¡ç†

å®Œæ•´çš„ CRUD æ“ä½œï¼Œæ”¯æŒè‰ç¨¿/å‘å¸ƒçŠ¶æ€ï¼Œæ”¯æŒç‚¹èµã€æ”¶è—ã€æµè§ˆç»Ÿè®¡ã€‚

### 4. è¯„è®ºç³»ç»Ÿ

æ”¯æŒå‘è¡¨è¯„è®ºã€å›å¤è¯„è®ºã€ç‚¹èµè¯„è®ºã€åˆ é™¤è¯„è®ºã€‚

### 5. æœç´¢åŠŸèƒ½

æ”¯æŒæŒ‰æ ‡é¢˜ã€æè¿°æœç´¢ï¼Œæä¾›çƒ­é—¨æœç´¢è¯å’Œæœç´¢å»ºè®®ã€‚

### 6. è´­ç‰©æ¸…å•

ç”¨æˆ·å¯ä»¥å°†é£Ÿè°±ä¸­çš„é£Ÿææ·»åŠ åˆ°è´­ç‰©æ¸…å•ï¼Œæ”¯æŒå‹¾é€‰å·²è´­ä¹°ã€‚

### 7. åˆ†ç±»ç®¡ç†

é¢„è®¾10ä¸ªåˆ†ç±»ï¼Œæ”¯æŒæŒ‰åˆ†ç±»æµè§ˆé£Ÿè°±ã€‚

### 8. æ–‡ä»¶ä¸Šä¼ 

æ”¯æŒå•å¼ å’Œæ‰¹é‡å›¾ç‰‡ä¸Šä¼ ï¼Œç”¨äºé£Ÿè°±å°é¢ã€æ­¥éª¤å›¾ã€è¯„è®ºå›¾ç‰‡ç­‰ã€‚

### 9. ç»Ÿè®¡åŠŸèƒ½

æä¾›é¦–é¡µæ¨èã€çƒ­é—¨é£Ÿè°±ã€å¹³å°ç»Ÿè®¡ç­‰æ•°æ®æ¥å£ã€‚

---

## ğŸ“ å¾…ç”¨æˆ·æä¾›çš„é…ç½®

åœ¨æ­£å¼éƒ¨ç½²å‰ï¼Œéœ€è¦æ‚¨æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š

### 1. æ•°æ®åº“é…ç½®

**å·²åˆ‡æ¢ä¸ºå¾®ä¿¡äº‘æ‰˜ç®¡ MySQL**

```env
DB_HOST=æ‚¨çš„äº‘æ•°æ®åº“å†…ç½‘åœ°å€
DB_PORT=3306
DB_USER=æ‚¨çš„æ•°æ®åº“è´¦å·
DB_PASSWORD=æ‚¨çš„æ•°æ®åº“å¯†ç 
DB_NAME=cooktip
```

è¯¦ç»†é…ç½®è¯·å‚è€ƒï¼š[äº‘æ•°æ®åº“é…ç½®.md](./äº‘æ•°æ®åº“é…ç½®.md)

### 2. å¾®ä¿¡å°ç¨‹åºé…ç½®

```env
WECHAT_APPID=your-miniprogram-appid
WECHAT_SECRET=your-miniprogram-secret
```

### 3. JWT å¯†é’¥ï¼ˆé‡è¦ï¼‰

```env
JWT_SECRET=your-super-secure-jwt-secret-key-min-32-chars
```

---

## ğŸ”’ å®‰å…¨æªæ–½

- âœ… JWT Token è®¤è¯
- âœ… å‚æ•°éªŒè¯ï¼ˆclass-validatorï¼‰
- âœ… SQL æ³¨å…¥é˜²æŠ¤ï¼ˆTypeORMï¼‰
- âœ… XSS é˜²æŠ¤
- âœ… CORS é…ç½®
- âœ… API é™æµä¿æŠ¤
- âœ… å¯†ç å®‰å…¨ï¼ˆé¢„ç•™ï¼‰

---

## ğŸ“¦ éƒ¨ç½²æ–¹å¼

é¡¹ç›®æ”¯æŒå¤šç§éƒ¨ç½²æ–¹å¼ï¼š

1. **ç›´æ¥éƒ¨ç½²** - Node.js + PM2
2. **Docker éƒ¨ç½²** - å•å®¹å™¨éƒ¨ç½²
3. **Docker Compose** - å®¹å™¨ç¼–æ’ï¼ˆæ¨èï¼‰
4. **å¾®ä¿¡äº‘æ‰˜ç®¡** - äº‘åŸç”Ÿéƒ¨ç½²

è¯¦ç»†éƒ¨ç½²æŒ‡å—è¯·æŸ¥çœ‹ `éƒ¨ç½²æŒ‡å—.md`

---

## ğŸ¯ ä¸‹ä¸€æ­¥å»ºè®®

### åŠŸèƒ½æ‰©å±•

1. â­ ç”¨æˆ·å…³æ³¨/ç²‰ä¸åŠŸèƒ½
2. â­ é£Ÿè°±æ”¶è—å¤¹åˆ†ç»„
3. â­ AI èœè°±æ¨è
4. â­ é£Ÿæè¥å…»åˆ†æ
5. â­ çƒ¹é¥ªè§†é¢‘ä¸Šä¼ 
6. â­ ç”¨æˆ·ç­‰çº§å’Œç§¯åˆ†ç³»ç»Ÿ
7. â­ ç§ä¿¡åŠŸèƒ½
8. â­ æ´»åŠ¨å’Œè¯é¢˜

### æ€§èƒ½ä¼˜åŒ–

1. â­ Redis ç¼“å­˜é›†æˆ
2. â­ æ•°æ®åº“è¯»å†™åˆ†ç¦»
3. â­ CDN åŠ é€Ÿï¼ˆå›¾ç‰‡ï¼‰
4. â­ å…¨æ–‡æœç´¢ï¼ˆElasticsearchï¼‰
5. â­ æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆRabbitMQï¼‰

### è¿ç»´ç›‘æ§

1. â­ æ—¥å¿—ç³»ç»Ÿï¼ˆELKï¼‰
2. â­ ç›‘æ§å‘Šè­¦ï¼ˆPrometheus + Grafanaï¼‰
3. â­ é“¾è·¯è¿½è¸ªï¼ˆZipkinï¼‰
4. â­ æ€§èƒ½åˆ†æï¼ˆAPMï¼‰

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [åç«¯APIå¼€å‘æ–‡æ¡£.md](./åç«¯APIå¼€å‘æ–‡æ¡£.md) - å®Œæ•´APIæ¥å£æ–‡æ¡£
- [åç«¯æŠ€æœ¯é€‰å‹æ–¹æ¡ˆ.md](./åç«¯æŠ€æœ¯é€‰å‹æ–¹æ¡ˆ.md) - æŠ€æœ¯é€‰å‹è¯´æ˜
- [é¡¹ç›®è¯´æ˜.md](./é¡¹ç›®è¯´æ˜.md) - é¡¹ç›®ä½¿ç”¨è¯´æ˜
- [éƒ¨ç½²æŒ‡å—.md](./éƒ¨ç½²æŒ‡å—.md) - éƒ¨ç½²æ–‡æ¡£

---

## ğŸ‘¨â€ğŸ’» å¼€å‘è€…ä¿¡æ¯

- **é¡¹ç›®åç§°**: CookTip ç¾é£Ÿèœè°±å°ç¨‹åºåç«¯
- **å¼€å‘æ¡†æ¶**: Nest.js + TypeScript
- **æ•°æ®åº“**: MySQL (SQLPub)
- **å¼€å‘æ—¶é—´**: 2025-01-08
- **è”ç³»é‚®ç®±**: 3509204288@qq.com

---

## âœ… éªŒæ”¶æ¸…å•

- [x] 40ä¸ªAPIæ¥å£å…¨éƒ¨å®ç°
- [x] 7å¼ æ•°æ®åº“è¡¨è®¾è®¡å®Œæˆ
- [x] å¾®ä¿¡ç™»å½•è®¤è¯åŠŸèƒ½
- [x] JWT Token è®¤è¯
- [x] é£Ÿè°±CRUDåŠŸèƒ½
- [x] è¯„è®ºå’Œå›å¤åŠŸèƒ½
- [x] ç‚¹èµå’Œæ”¶è—åŠŸèƒ½
- [x] æœç´¢åŠŸèƒ½
- [x] è´­ç‰©æ¸…å•åŠŸèƒ½
- [x] åˆ†ç±»ç®¡ç†
- [x] æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½
- [x] ç»Ÿè®¡å’Œæ¨èåŠŸèƒ½
- [x] Swagger APIæ–‡æ¡£
- [x] Dockeréƒ¨ç½²é…ç½®
- [x] æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
- [x] å®Œæ•´çš„é¡¹ç›®è¯´æ˜æ–‡æ¡£
- [x] éƒ¨ç½²æŒ‡å—æ–‡æ¡£

---

## ğŸŠ é¡¹ç›®å®Œæˆ

**æ­å–œï¼CookTip ç¾é£Ÿèœè°±å°ç¨‹åºåç«¯å·²ç»å¼€å‘å®Œæˆï¼**

æ‰€æœ‰åŠŸèƒ½æ¨¡å—éƒ½å·²å®ç°ï¼Œä»£ç ç»“æ„æ¸…æ™°ï¼Œæ–‡æ¡£å®Œå–„ï¼Œå¯ä»¥ç›´æ¥éƒ¨ç½²ä½¿ç”¨ã€‚

å¦‚éœ€ä»»ä½•è°ƒæ•´æˆ–æœ‰ç–‘é—®ï¼Œè¯·éšæ—¶è”ç³»ã€‚

---

**CookTip å¼€å‘å›¢é˜Ÿ** ğŸ³  
**2025-01-08**

