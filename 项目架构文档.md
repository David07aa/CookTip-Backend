# CookTip é¡¹ç›®æ¶æ„æ–‡æ¡£

<div align="center">
  <h2>ğŸ³ ç¾é£Ÿèœè°±å°ç¨‹åº - å®Œæ•´æŠ€æœ¯æ¶æ„</h2>
  <p>å¾®ä¿¡å°ç¨‹åº + NestJSåç«¯ + äº‘æ‰˜ç®¡ + å¯¹è±¡å­˜å‚¨</p>
</div>

---

## ğŸ“‘ ç›®å½•

- [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
- [æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)
- [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
- [ç›®å½•ç»“æ„](#ç›®å½•ç»“æ„)
- [æ ¸å¿ƒåŠŸèƒ½](#æ ¸å¿ƒåŠŸèƒ½)
- [æ•°æ®åº“è®¾è®¡](#æ•°æ®åº“è®¾è®¡)
- [APIæ–‡æ¡£](#apiæ–‡æ¡£)
- [éƒ¨ç½²æ¶æ„](#éƒ¨ç½²æ¶æ„)
- [å¼€å‘æŒ‡å—](#å¼€å‘æŒ‡å—)
- [æ–‡æ¡£ç´¢å¼•](#æ–‡æ¡£ç´¢å¼•)

---

## é¡¹ç›®æ¦‚è¿°

### åŸºæœ¬ä¿¡æ¯

| é¡¹ç›® | ä¿¡æ¯ |
|------|------|
| é¡¹ç›®åç§° | CookTip - ç¾é£Ÿèœè°±å°ç¨‹åº |
| å‰ç«¯å¹³å° | å¾®ä¿¡å°ç¨‹åº |
| åç«¯æ¡†æ¶ | Nest.js (TypeScript) |
| æ•°æ®åº“ | MySQL 8.0 (å¾®ä¿¡äº‘æ‰˜ç®¡CynosDB) |
| éƒ¨ç½²å¹³å° | å¾®ä¿¡äº‘æ‰˜ç®¡ (Dockerå®¹å™¨) |
| å¯¹è±¡å­˜å‚¨ | è…¾è®¯äº‘COS (å—äº¬) |
| å½“å‰ç‰ˆæœ¬ | v1.0.0 |

### é¡¹ç›®ç‰¹ç‚¹

- âœ… **æŠ€æœ¯æ ˆç»Ÿä¸€**ï¼šå‰åç«¯å‡ä½¿ç”¨TypeScriptï¼Œé™ä½å­¦ä¹ æˆæœ¬
- âœ… **äº‘åŸç”Ÿæ¶æ„**ï¼šåŸºäºå¾®ä¿¡äº‘æ‰˜ç®¡ï¼Œå®¹å™¨åŒ–éƒ¨ç½²
- âœ… **é«˜æ€§èƒ½**ï¼šå†…ç½‘è®¿é—®æ•°æ®åº“ï¼Œå»¶è¿Ÿ<1ms
- âœ… **ä½æˆæœ¬**ï¼šäº‘æ‰˜ç®¡æŒ‰é‡è®¡è´¹ï¼Œå¯¹è±¡å­˜å‚¨ç‹¬ç«‹
- âœ… **æ˜“æ‰©å±•**ï¼šæ¨¡å—åŒ–è®¾è®¡ï¼Œæ˜“äºåŠŸèƒ½æ‰©å±•

---

## æŠ€æœ¯æ¶æ„

### ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å¾®ä¿¡å°ç¨‹åºç«¯                              â”‚
â”‚                   (TypeScript + WXML)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  é¦–é¡µ/æœç´¢  â”‚  â”‚  é£Ÿè°±è¯¦æƒ…   â”‚  â”‚  ä¸ªäººä¸­å¿ƒ   â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ HTTPS
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     äº‘å‡½æ•° APIç½‘å…³                            â”‚
â”‚              (api-proxy - è¯·æ±‚è½¬å‘)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  å¾®ä¿¡äº‘æ‰˜ç®¡ (åç«¯æœåŠ¡)                         â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              NestJS åº”ç”¨ (TypeScript)                   â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚  Controller Layer (APIç«¯ç‚¹)                       â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ AuthController      â€¢ RecipeController       â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ UserController      â€¢ CommentController      â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ CategoryController  â€¢ SearchController       â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚  Service Layer (ä¸šåŠ¡é€»è¾‘)                          â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ JWTè®¤è¯  â€¢ å¾®ä¿¡ç™»å½•  â€¢ æ•°æ®éªŒè¯  â€¢ ä¸šåŠ¡é€»è¾‘  â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚  Repository Layer (æ•°æ®è®¿é—®)                       â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  TypeORM - Entity - MySQL Driver                â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  ä¸­é—´ä»¶/å®ˆå«/æ‹¦æˆªå™¨                                      â”‚ â”‚
â”‚  â”‚  â€¢ JwtAuthGuard  â€¢ TransformInterceptor                â”‚ â”‚
â”‚  â”‚  â€¢ ThrottlerGuard  â€¢ HttpExceptionFilter             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                                   â”‚
            â†“                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¾®ä¿¡äº‘æ‰˜ç®¡ CynosDB   â”‚          â”‚   è…¾è®¯äº‘ COS         â”‚
â”‚  (MySQL 8.0)         â”‚          â”‚   (å¯¹è±¡å­˜å‚¨-å—äº¬)     â”‚
â”‚                      â”‚          â”‚                      â”‚
â”‚  â€¢ users (ç”¨æˆ·)      â”‚          â”‚  â€¢ é£Ÿè°±å›¾ç‰‡           â”‚
â”‚  â€¢ recipes (é£Ÿè°±)    â”‚          â”‚  â€¢ ç”¨æˆ·å¤´åƒ           â”‚
â”‚  â€¢ categories (åˆ†ç±») â”‚          â”‚  â€¢ æ­¥éª¤å›¾ç‰‡           â”‚
â”‚  â€¢ comments (è¯„è®º)   â”‚          â”‚  â€¢ è§†é¢‘å°é¢           â”‚
â”‚  â€¢ favorites (æ”¶è—)  â”‚          â”‚                      â”‚
â”‚  â€¢ likes (ç‚¹èµ)      â”‚          â”‚  åŸŸå:               â”‚
â”‚  â€¢ shopping_lists    â”‚          â”‚  yjsp-1367462091    â”‚
â”‚                      â”‚          â”‚  .cos.ap-nanjing    â”‚
â”‚  å†…ç½‘: 10.32.104.73  â”‚          â”‚  .myqcloud.com      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è¯·æ±‚æµç¨‹

#### å°ç¨‹åºAPIè¯·æ±‚æµç¨‹
```
1. å°ç¨‹åº â†’ wx.cloud.callFunction('api-proxy')
2. äº‘å‡½æ•° â†’ è½¬å‘è¯·æ±‚åˆ°äº‘æ‰˜ç®¡åç«¯
3. äº‘æ‰˜ç®¡ â†’ NestJSå¤„ç†ä¸šåŠ¡é€»è¾‘
4. NestJS â†’ æŸ¥è¯¢äº‘æ‰˜ç®¡æ•°æ®åº“(å†…ç½‘)
5. è¿”å›å“åº”ï¼šæ•°æ®åº“ â†’ NestJS â†’ äº‘å‡½æ•° â†’ å°ç¨‹åº
```

#### å›¾ç‰‡è®¿é—®æµç¨‹
```
1. å°ç¨‹åº â†’ <image src="https://yjsp-1367462091.cos..." />
2. ç›´æ¥è®¿é—®è…¾è®¯äº‘COSå¯¹è±¡å­˜å‚¨
3. COS â†’ è¿”å›å›¾ç‰‡èµ„æº
```

---

## æŠ€æœ¯æ ˆ

### åç«¯æŠ€æœ¯æ ˆ

| ç±»åˆ« | æŠ€æœ¯ | ç‰ˆæœ¬ | è¯´æ˜ |
|------|------|------|------|
| **æ ¸å¿ƒæ¡†æ¶** | NestJS | 10.x | ä¼ä¸šçº§Node.jsæ¡†æ¶ |
| **å¼€å‘è¯­è¨€** | TypeScript | 5.x | ç±»å‹å®‰å…¨çš„JavaScriptè¶…é›† |
| **æ•°æ®åº“** | MySQL | 8.0 | å…³ç³»å‹æ•°æ®åº“ |
| **ORM** | TypeORM | 0.3.x | å¯¹è±¡å…³ç³»æ˜ å°„ |
| **èº«ä»½è®¤è¯** | JWT | - | JSON Web Token |
| **æ¥å£æ–‡æ¡£** | Swagger | - | è‡ªåŠ¨ç”ŸæˆAPIæ–‡æ¡£ |
| **HTTPå®¢æˆ·ç«¯** | Axios | 1.x | Promise based HTTP client |
| **ç¯å¢ƒé…ç½®** | dotenv | - | ç¯å¢ƒå˜é‡ç®¡ç† |
| **å®¹å™¨åŒ–** | Docker | - | å®¹å™¨åŒ–éƒ¨ç½² |
| **é™æµ** | @nestjs/throttler | - | è¯·æ±‚é¢‘ç‡é™åˆ¶ |
| **éªŒè¯** | class-validator | - | æ•°æ®éªŒè¯ |
| **è½¬æ¢** | class-transformer | - | å¯¹è±¡è½¬æ¢ |

### å‰ç«¯æŠ€æœ¯æ ˆ (å°ç¨‹åº)

| ç±»åˆ« | æŠ€æœ¯ | è¯´æ˜ |
|------|------|------|
| **å¼€å‘è¯­è¨€** | JavaScript/TypeScript | å°ç¨‹åºå¼€å‘è¯­è¨€ |
| **è§†å›¾å±‚** | WXML + WXSS | å°ç¨‹åºæ ‡è®°è¯­è¨€ |
| **äº‘å¼€å‘** | äº‘å‡½æ•° | APIç½‘å…³ä»£ç† |
| **çŠ¶æ€ç®¡ç†** | æœ¬åœ°å­˜å‚¨ | ç¼“å­˜ç”¨æˆ·ä¿¡æ¯ |

### åŸºç¡€è®¾æ–½

| æœåŠ¡ | æä¾›å•† | è¯´æ˜ |
|------|--------|------|
| **äº‘æ‰˜ç®¡** | è…¾è®¯äº‘å¾®ä¿¡äº‘æ‰˜ç®¡ | Dockerå®¹å™¨æ‰˜ç®¡ |
| **æ•°æ®åº“** | å¾®ä¿¡äº‘æ‰˜ç®¡CynosDB | MySQL 8.0å…¼å®¹ |
| **å¯¹è±¡å­˜å‚¨** | è…¾è®¯äº‘COS | å›¾ç‰‡/è§†é¢‘å­˜å‚¨ |
| **äº‘å‡½æ•°** | å¾®ä¿¡äº‘å¼€å‘ | APIç½‘å…³ä»£ç† |

---

## ç›®å½•ç»“æ„

### åç«¯é¡¹ç›®ç»“æ„

```
CookTip-Backend/
â”œâ”€â”€ src/                           # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ modules/                   # ä¸šåŠ¡æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ auth/                 # è®¤è¯æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.module.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ jwt.strategy.ts
â”‚   â”‚   â”‚   â””â”€â”€ dto/
â”‚   â”‚   â”œâ”€â”€ user/                 # ç”¨æˆ·æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ user.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ user.service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ user.module.ts
â”‚   â”‚   â”‚   â””â”€â”€ dto/
â”‚   â”‚   â”œâ”€â”€ recipe/               # é£Ÿè°±æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ recipe.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ recipe.service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ recipe.module.ts
â”‚   â”‚   â”‚   â””â”€â”€ dto/
â”‚   â”‚   â”œâ”€â”€ category/             # åˆ†ç±»æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ comment/              # è¯„è®ºæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ favorite/             # æ”¶è—æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ search/               # æœç´¢æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ stats/                # ç»Ÿè®¡æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ upload/               # ä¸Šä¼ æ¨¡å—
â”‚   â”‚   â””â”€â”€ shopping-list/        # è´­ç‰©æ¸…å•æ¨¡å—
â”‚   â”œâ”€â”€ entities/                 # æ•°æ®å®ä½“
â”‚   â”‚   â”œâ”€â”€ user.entity.ts
â”‚   â”‚   â”œâ”€â”€ recipe.entity.ts
â”‚   â”‚   â”œâ”€â”€ category.entity.ts
â”‚   â”‚   â”œâ”€â”€ comment.entity.ts
â”‚   â”‚   â”œâ”€â”€ favorite.entity.ts
â”‚   â”‚   â”œâ”€â”€ like.entity.ts
â”‚   â”‚   â””â”€â”€ shopping-list.entity.ts
â”‚   â”œâ”€â”€ common/                   # å…¬å…±æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ decorators/           # è£…é¥°å™¨
â”‚   â”‚   â”œâ”€â”€ filters/              # å¼‚å¸¸è¿‡æ»¤å™¨
â”‚   â”‚   â”œâ”€â”€ guards/               # å®ˆå«
â”‚   â”‚   â””â”€â”€ interceptors/         # æ‹¦æˆªå™¨
â”‚   â”œâ”€â”€ app.module.ts             # æ ¹æ¨¡å—
â”‚   â”œâ”€â”€ main.ts                   # åº”ç”¨å…¥å£
â”‚   â””â”€â”€ health.controller.ts      # å¥åº·æ£€æŸ¥
â”œâ”€â”€ database/                      # æ•°æ®åº“è„šæœ¬
â”‚   â”œâ”€â”€ init.sql                  # åˆå§‹åŒ–è„šæœ¬
â”‚   â””â”€â”€ seed.sql                  # æµ‹è¯•æ•°æ®
â”œâ”€â”€ scripts/                       # å·¥å…·è„šæœ¬
â”‚   â”œâ”€â”€ check-database-images.js  # æ£€æŸ¥æ•°æ®åº“å›¾ç‰‡
â”‚   â”œâ”€â”€ update-image-urls.js      # æ›´æ–°å›¾ç‰‡URL
â”‚   â””â”€â”€ check-and-update-image-urls.sql
â”œâ”€â”€ cloudfunctions/                # äº‘å‡½æ•°
â”‚   â””â”€â”€ api-proxy/                # APIç½‘å…³ä»£ç†
â”‚       â”œâ”€â”€ index.js
â”‚       â”œâ”€â”€ package.json
â”‚       â”œâ”€â”€ config.json
â”‚       â””â”€â”€ README.md
â”œâ”€â”€ miniprogram-utils/             # å°ç¨‹åºå·¥å…·
â”‚   â”œâ”€â”€ cdn.js                    # CDNé…ç½®
â”‚   â”œâ”€â”€ cloudRequest.js           # äº‘å‡½æ•°è¯·æ±‚
â”‚   â”œâ”€â”€ api.js                    # APIå°è£…
â”‚   â””â”€â”€ ä½¿ç”¨ç¤ºä¾‹.md
â”œâ”€â”€ dist/                          # ç¼–è¯‘è¾“å‡º
â”œâ”€â”€ node_modules/                  # ä¾èµ–åŒ…
â”œâ”€â”€ Dockerfile                     # Dockeré…ç½®
â”œâ”€â”€ docker-compose.yml             # Docker Composeé…ç½®
â”œâ”€â”€ package.json                   # é¡¹ç›®é…ç½®
â”œâ”€â”€ tsconfig.json                  # TypeScripté…ç½®
â”œâ”€â”€ nest-cli.json                  # NestJS CLIé…ç½®
â”œâ”€â”€ .env.example                   # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ cloudbase-env-vars.json        # äº‘æ‰˜ç®¡ç¯å¢ƒå˜é‡
â”œâ”€â”€ cloudbaserc.json               # äº‘æ‰˜ç®¡é…ç½®
â””â”€â”€ README.md                      # é¡¹ç›®è¯´æ˜
```

### æ–‡æ¡£ç›®å½•ç»“æ„

```
docs/
â”œâ”€â”€ é¡¹ç›®æ¶æ„æ–‡æ¡£.md               # æœ¬æ–‡æ¡£
â”œâ”€â”€ README.md                     # é¡¹ç›®æ€»è§ˆ
â”œâ”€â”€ åç«¯APIå¼€å‘æ–‡æ¡£.md            # APIæ¥å£æ–‡æ¡£
â”œâ”€â”€ åç«¯æŠ€æœ¯é€‰å‹æ–¹æ¡ˆ.md           # æŠ€æœ¯é€‰å‹
â”œâ”€â”€ å‰ç«¯å¯¹æ¥æ–‡æ¡£-æ–°ç‰ˆ.md          # å‰ç«¯å¯¹æ¥
â”œâ”€â”€ äº‘å‡½æ•°éƒ¨ç½²å®Œæ•´æŒ‡å—.md         # äº‘å‡½æ•°éƒ¨ç½²
â”œâ”€â”€ äº‘å‡½æ•°APIç½‘å…³-README.md       # APIç½‘å…³è¯´æ˜
â””â”€â”€ äº‘å‡½æ•°å¿«é€Ÿå‚è€ƒ.md             # äº‘å‡½æ•°å‚è€ƒ
```

---

## æ ¸å¿ƒåŠŸèƒ½

### 1. ç”¨æˆ·è®¤è¯ä¸æˆæƒ

| åŠŸèƒ½ | ç«¯ç‚¹ | è¯´æ˜ |
|------|------|------|
| å¾®ä¿¡ç™»å½• | `POST /auth/login/wechat` | é€šè¿‡å¾®ä¿¡codeæ¢å–session |
| åˆ·æ–°Token | `POST /auth/refresh` | åˆ·æ–°JWT token |
| é€€å‡ºç™»å½• | `POST /auth/logout` | é€€å‡ºå½“å‰è´¦æˆ· |

**æŠ€æœ¯å®ç°**ï¼š
- å¾®ä¿¡å°ç¨‹åºcodeæ¢å–session_keyå’Œopenid
- ç”ŸæˆJWT token
- Tokenå­˜å‚¨åœ¨å°ç¨‹åºStorage
- è¯·æ±‚æºå¸¦Authorization header

### 2. é£Ÿè°±ç®¡ç†

| åŠŸèƒ½ | ç«¯ç‚¹ | è¯´æ˜ |
|------|------|------|
| è·å–é£Ÿè°±åˆ—è¡¨ | `GET /recipes` | åˆ†é¡µã€æ’åºã€ç­›é€‰ |
| è·å–é£Ÿè°±è¯¦æƒ… | `GET /recipes/:id` | å«å®Œæ•´ä¿¡æ¯ |
| åˆ›å»ºé£Ÿè°± | `POST /recipes` | éœ€è¦è®¤è¯ |
| æ›´æ–°é£Ÿè°± | `PATCH /recipes/:id` | éœ€è¦è®¤è¯ |
| åˆ é™¤é£Ÿè°± | `DELETE /recipes/:id` | éœ€è¦è®¤è¯ |
| ç‚¹èµ/å–æ¶ˆ | `POST /recipes/:id/like` | éœ€è¦è®¤è¯ |
| æ”¶è—/å–æ¶ˆ | `POST /recipes/:id/favorite` | éœ€è¦è®¤è¯ |
| å¢åŠ æµè§ˆé‡ | `POST /recipes/:id/view` | æ— éœ€è®¤è¯ |

**æ ¸å¿ƒå­—æ®µ**ï¼š
- åŸºæœ¬ä¿¡æ¯ï¼šæ ‡é¢˜ã€æè¿°ã€åˆ†ç±»
- çƒ¹é¥ªä¿¡æ¯ï¼šéš¾åº¦ã€æ—¶é—´ã€ä»½æ•°ã€å£å‘³
- è¯¦ç»†å†…å®¹ï¼šé£Ÿæåˆ—è¡¨ã€æ­¥éª¤ã€å°è´´å£«
- ç»Ÿè®¡ä¿¡æ¯ï¼šç‚¹èµæ•°ã€æ”¶è—æ•°ã€æµè§ˆæ•°ã€è¯„è®ºæ•°

### 3. åˆ†ç±»ç®¡ç†

| åŠŸèƒ½ | ç«¯ç‚¹ | è¯´æ˜ |
|------|------|------|
| è·å–åˆ†ç±»åˆ—è¡¨ | `GET /categories` | æ‰€æœ‰åˆ†ç±» |
| è·å–åˆ†ç±»è¯¦æƒ… | `GET /categories/:id` | å«é£Ÿè°±æ•°é‡ |

**é¢„è®¾åˆ†ç±»**ï¼š
- ä¸»é£Ÿï¼ˆç±³é¥­ã€é¢æ¡ã€é¥ºå­ç­‰ï¼‰
- ç‚’èœï¼ˆå®¶å¸¸ç‚’èœï¼‰
- å‡‰æ‹Œï¼ˆå‡‰èœï¼‰
- çƒ˜ç„™ç”œç‚¹
- ç‚–èœï¼ˆç‚–ç…®ç±»ï¼‰
- æ±¤ï¼ˆæ±¤ç±»ï¼‰

### 4. è¯„è®ºç³»ç»Ÿ

| åŠŸèƒ½ | ç«¯ç‚¹ | è¯´æ˜ |
|------|------|------|
| è·å–è¯„è®ºåˆ—è¡¨ | `GET /comments` | æ”¯æŒç­›é€‰é£Ÿè°± |
| åˆ›å»ºè¯„è®º | `POST /comments` | éœ€è¦è®¤è¯ |
| åˆ é™¤è¯„è®º | `DELETE /comments/:id` | éœ€è¦è®¤è¯ |

### 5. æ”¶è—åŠŸèƒ½

| åŠŸèƒ½ | ç«¯ç‚¹ | è¯´æ˜ |
|------|------|------|
| è·å–æ”¶è—åˆ—è¡¨ | `GET /favorites` | å½“å‰ç”¨æˆ·æ”¶è— |
| æ·»åŠ æ”¶è— | `POST /favorites` | éœ€è¦è®¤è¯ |
| å–æ¶ˆæ”¶è— | `DELETE /favorites/:id` | éœ€è¦è®¤è¯ |

### 6. æœç´¢åŠŸèƒ½

| åŠŸèƒ½ | ç«¯ç‚¹ | è¯´æ˜ |
|------|------|------|
| æœç´¢é£Ÿè°± | `GET /search/recipes` | å…³é”®è¯æœç´¢ |

**æœç´¢å­—æ®µ**ï¼šæ ‡é¢˜ã€æè¿°ã€é£Ÿæã€æ ‡ç­¾

### 7. ç»Ÿè®¡åˆ†æ

| åŠŸèƒ½ | ç«¯ç‚¹ | è¯´æ˜ |
|------|------|------|
| è·å–ç»Ÿè®¡ä¿¡æ¯ | `GET /stats` | æ¦‚è§ˆç»Ÿè®¡ |

**ç»Ÿè®¡å†…å®¹**ï¼š
- æ€»é£Ÿè°±æ•°
- æ€»ç”¨æˆ·æ•°
- ä»Šæ—¥æ–°å¢é£Ÿè°±
- çƒ­é—¨é£Ÿè°±Top 10

### 8. è´­ç‰©æ¸…å•

| åŠŸèƒ½ | ç«¯ç‚¹ | è¯´æ˜ |
|------|------|------|
| è·å–è´­ç‰©æ¸…å• | `GET /shopping-list` | å½“å‰ç”¨æˆ·æ¸…å• |
| æ·»åŠ é£Ÿæ | `POST /shopping-list` | éœ€è¦è®¤è¯ |
| æ›´æ–°çŠ¶æ€ | `PATCH /shopping-list/:id` | æ ‡è®°å·²è´­ä¹° |
| åˆ é™¤é£Ÿæ | `DELETE /shopping-list/:id` | éœ€è¦è®¤è¯ |

### 9. æ–‡ä»¶ä¸Šä¼ 

| åŠŸèƒ½ | ç«¯ç‚¹ | è¯´æ˜ |
|------|------|------|
| ä¸Šä¼ å•å¼ å›¾ç‰‡ | `POST /upload/image` | å°é¢ã€å¤´åƒç­‰ |
| æ‰¹é‡ä¸Šä¼ å›¾ç‰‡ | `POST /upload/images` | æ­¥éª¤å›¾ç­‰ |

**ä¸Šä¼ ç±»å‹**ï¼š
- cover: å°é¢å›¾
- step: æ­¥éª¤å›¾
- comment: è¯„è®ºå›¾
- avatar: å¤´åƒ

---

## æ•°æ®åº“è®¾è®¡

### ERå›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   users    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”‚  recipes   â”‚â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ categories â”‚
â”‚            â”‚        â”‚            â”‚        â”‚            â”‚
â”‚ â€¢ id       â”‚        â”‚ â€¢ id       â”‚        â”‚ â€¢ id       â”‚
â”‚ â€¢ openid   â”‚        â”‚ â€¢ user_id  â”‚        â”‚ â€¢ name     â”‚
â”‚ â€¢ nickname â”‚        â”‚ â€¢ category â”‚        â”‚ â€¢ icon     â”‚
â”‚ â€¢ avatar   â”‚        â”‚ â€¢ title    â”‚        â”‚ â€¢ count    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚ â€¢ cover    â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚               â”‚ â€¢ content  â”‚
      â”‚               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                     â”‚
      â”‚                     â”‚
      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚                         â”‚           â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  comments  â”‚           â”‚ favorites  â”‚  â”‚   likes    â”‚
      â”‚            â”‚           â”‚            â”‚  â”‚            â”‚
      â”‚ â€¢ id       â”‚           â”‚ â€¢ id       â”‚  â”‚ â€¢ id       â”‚
      â”‚ â€¢ user_id  â”‚           â”‚ â€¢ user_id  â”‚  â”‚ â€¢ user_id  â”‚
      â”‚ â€¢ recipe   â”‚           â”‚ â€¢ recipe   â”‚  â”‚ â€¢ target   â”‚
      â”‚ â€¢ content  â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¸»è¦æ•°æ®è¡¨

#### 1. users - ç”¨æˆ·è¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | INT PRIMARY KEY | ç”¨æˆ·ID |
| openid | VARCHAR(100) UNIQUE | å¾®ä¿¡å”¯ä¸€æ ‡è¯† |
| nickname | VARCHAR(50) | æ˜µç§° |
| avatar | VARCHAR(255) | å¤´åƒURL |
| bio | TEXT | ä¸ªäººç®€ä»‹ |
| recipe_count | INT | å‘å¸ƒé£Ÿè°±æ•° |
| favorite_count | INT | æ”¶è—æ•° |
| follower_count | INT | ç²‰ä¸æ•° |
| following_count | INT | å…³æ³¨æ•° |
| created_at | TIMESTAMP | åˆ›å»ºæ—¶é—´ |
| updated_at | TIMESTAMP | æ›´æ–°æ—¶é—´ |

#### 2. recipes - é£Ÿè°±è¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | INT PRIMARY KEY | é£Ÿè°±ID |
| user_id | INT | ä½œè€…ID |
| category_id | INT | åˆ†ç±»ID |
| title | VARCHAR(100) | æ ‡é¢˜ |
| cover_image | VARCHAR(255) | å°é¢å›¾ |
| description | TEXT | æè¿° |
| difficulty | VARCHAR(20) | éš¾åº¦ |
| cook_time | INT | çƒ¹é¥ªæ—¶é—´(åˆ†é’Ÿ) |
| servings | INT | ä»½æ•° |
| taste | VARCHAR(50) | å£å‘³ |
| ingredients | JSON | é£Ÿæåˆ—è¡¨ |
| steps | JSON | æ­¥éª¤åˆ—è¡¨ |
| tips | TEXT | å°è´´å£« |
| tags | JSON | æ ‡ç­¾ |
| likes | INT | ç‚¹èµæ•° |
| favorites | INT | æ”¶è—æ•° |
| views | INT | æµè§ˆæ•° |
| comments | INT | è¯„è®ºæ•° |
| status | VARCHAR(20) | çŠ¶æ€ |
| created_at | TIMESTAMP | åˆ›å»ºæ—¶é—´ |
| updated_at | TIMESTAMP | æ›´æ–°æ—¶é—´ |

#### 3. categories - åˆ†ç±»è¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | INT PRIMARY KEY | åˆ†ç±»ID |
| name | VARCHAR(50) | åˆ†ç±»å |
| icon | VARCHAR(255) | å›¾æ ‡ |
| description | TEXT | æè¿° |
| recipe_count | INT | é£Ÿè°±æ•°é‡ |
| sort_order | INT | æ’åº |

#### 4. comments - è¯„è®ºè¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | INT PRIMARY KEY | è¯„è®ºID |
| recipe_id | INT | é£Ÿè°±ID |
| user_id | INT | ç”¨æˆ·ID |
| content | TEXT | è¯„è®ºå†…å®¹ |
| images | JSON | å›¾ç‰‡åˆ—è¡¨ |
| likes | INT | ç‚¹èµæ•° |
| created_at | TIMESTAMP | åˆ›å»ºæ—¶é—´ |

#### 5. favorites - æ”¶è—è¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | INT PRIMARY KEY | æ”¶è—ID |
| user_id | INT | ç”¨æˆ·ID |
| recipe_id | INT | é£Ÿè°±ID |
| created_at | TIMESTAMP | åˆ›å»ºæ—¶é—´ |

#### 6. likes - ç‚¹èµè¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | INT PRIMARY KEY | ç‚¹èµID |
| user_id | INT | ç”¨æˆ·ID |
| target_type | VARCHAR(20) | ç›®æ ‡ç±»å‹ |
| target_id | INT | ç›®æ ‡ID |
| created_at | TIMESTAMP | åˆ›å»ºæ—¶é—´ |

#### 7. shopping_lists - è´­ç‰©æ¸…å•

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | INT PRIMARY KEY | æ¸…å•ID |
| user_id | INT | ç”¨æˆ·ID |
| recipe_id | INT | é£Ÿè°±ID |
| ingredient_name | VARCHAR(100) | é£Ÿæå |
| amount | VARCHAR(50) | æ•°é‡ |
| unit | VARCHAR(20) | å•ä½ |
| is_purchased | BOOLEAN | æ˜¯å¦å·²è´­ä¹° |
| created_at | TIMESTAMP | åˆ›å»ºæ—¶é—´ |

---

## APIæ–‡æ¡£

### æ¥å£è§„èŒƒ

#### è¯·æ±‚æ ¼å¼

```javascript
// é€šè¿‡äº‘å‡½æ•°ä»£ç†
wx.cloud.callFunction({
  name: 'api-proxy',
  data: {
    method: 'GET',
    path: '/api/v1/recipes',
    query: { page: 1, limit: 10 },
    body: {},
    headers: {
      'Authorization': 'Bearer <token>'
    }
  }
})
```

#### å“åº”æ ¼å¼

```javascript
// æˆåŠŸå“åº”
{
  "code": 200,
  "message": "success",
  "data": { /* å®é™…æ•°æ® */ },
  "timestamp": "2024-10-16T12:00:00.000Z"
}

// é”™è¯¯å“åº”
{
  "code": 400,
  "message": "é”™è¯¯ä¿¡æ¯",
  "error": "BadRequest",
  "timestamp": "2024-10-16T12:00:00.000Z"
}
```

#### çŠ¶æ€ç 

| çŠ¶æ€ç  | è¯´æ˜ |
|--------|------|
| 200 | æˆåŠŸ |
| 201 | åˆ›å»ºæˆåŠŸ |
| 400 | è¯·æ±‚å‚æ•°é”™è¯¯ |
| 401 | æœªæˆæƒ |
| 403 | ç¦æ­¢è®¿é—® |
| 404 | èµ„æºä¸å­˜åœ¨ |
| 429 | è¯·æ±‚è¿‡äºé¢‘ç¹ |
| 500 | æœåŠ¡å™¨é”™è¯¯ |

### Swaggeræ–‡æ¡£

è®¿é—®åœ°å€ï¼š`https://yjsp-ytg-191595-4-1367462091.sh.run.tcloudbase.com/api/docs`

---

## éƒ¨ç½²æ¶æ„

### ç¯å¢ƒé…ç½®

#### å¼€å‘ç¯å¢ƒ

```
æœ¬åœ°å¼€å‘ï¼šlocalhost:3000
æ•°æ®åº“ï¼šæœ¬åœ°MySQLæˆ–äº‘ç«¯æ•°æ®åº“
å¯¹è±¡å­˜å‚¨ï¼šè…¾è®¯äº‘COSæµ‹è¯•æ¡¶
```

#### ç”Ÿäº§ç¯å¢ƒ

```
äº‘æ‰˜ç®¡åœ°å€ï¼šhttps://yjsp-ytg-191595-4-1367462091.sh.run.tcloudbase.com
æ•°æ®åº“ï¼šå¾®ä¿¡äº‘æ‰˜ç®¡CynosDB MySQL 8.0
  - å†…ç½‘åœ°å€ï¼š10.32.104.73:3306
  - å¤–ç½‘åœ°å€ï¼šsh-cynosdbmysql-grp-qksrb4s2.sql.tencentcdb.com:23831
å¯¹è±¡å­˜å‚¨ï¼šè…¾è®¯äº‘COS (å—äº¬)
  - https://yjsp-1367462091.cos.ap-nanjing.myqcloud.com
```

### ç¯å¢ƒå˜é‡

#### åç«¯ç¯å¢ƒå˜é‡ (cloudbase-env-vars.json)

```json
{
  "NODE_ENV": "production",
  "PORT": "3000",
  "API_PREFIX": "api/v1",
  
  "DB_TYPE": "mysql",
  "DB_HOST": "10.32.104.73",
  "DB_PORT": "3306",
  "DB_USERNAME": "root",
  "DB_PASSWORD": "your_password",
  "DB_DATABASE": "cooktip",
  "DB_CHARSET": "utf8mb4",
  "DB_SYNCHRONIZE": "false",
  
  "JWT_SECRET": "your_jwt_secret_key",
  "JWT_EXPIRES_IN": "7d",
  
  "WX_APPID": "your_miniprogram_appid",
  "WX_SECRET": "your_miniprogram_secret",
  
  "CDN_BASE_URL": "https://yjsp-1367462091.cos.ap-nanjing.myqcloud.com",
  "UPLOAD_DESTINATION": "/app/uploads",
  "MAX_FILE_SIZE": "10485760",
  
  "THROTTLE_TTL": "60",
  "THROTTLE_LIMIT": "10"
}
```

#### å‰ç«¯å°ç¨‹åºåŸŸåé…ç½®

éœ€è¦åœ¨å¾®ä¿¡å°ç¨‹åºåå°é…ç½®ä»¥ä¸‹åŸŸåï¼š

**downloadFileåˆæ³•åŸŸå**ï¼š
```
https://yjsp-1367462091.cos.ap-nanjing.myqcloud.com
```

**uploadFileåˆæ³•åŸŸå**ï¼š
```
https://yjsp-ytg-191595-4-1367462091.sh.run.tcloudbase.com
https://yjsp-1367462091.cos.ap-nanjing.myqcloud.com
```

### éƒ¨ç½²æµç¨‹

#### 1. åç«¯éƒ¨ç½²ï¼ˆäº‘æ‰˜ç®¡ï¼‰

```bash
# æ¨é€ä»£ç åˆ°GitHub
git push origin main

# å¾®ä¿¡äº‘æ‰˜ç®¡è‡ªåŠ¨è§¦å‘éƒ¨ç½²
# æˆ–æ‰‹åŠ¨åœ¨äº‘æ‰˜ç®¡æ§åˆ¶å°è§¦å‘éƒ¨ç½²
```

#### 2. äº‘å‡½æ•°éƒ¨ç½²

```bash
# ä½¿ç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·
# 1. æ‰“å¼€cloudfunctions/api-proxy
# 2. å³é”® -> ä¸Šä¼ å¹¶éƒ¨ç½²ï¼šäº‘ç«¯å®‰è£…ä¾èµ–
```

#### 3. æ•°æ®åº“åˆå§‹åŒ–

```bash
# è¿æ¥äº‘æ‰˜ç®¡æ•°æ®åº“
mysql -h sh-cynosdbmysql-grp-qksrb4s2.sql.tencentcdb.com \\
      -P 23831 -u root -p

# æ‰§è¡Œåˆå§‹åŒ–è„šæœ¬
source database/init.sql
```

### Dockeré…ç½®

#### Dockerfile

```dockerfile
FROM node:16-alpine

WORKDIR /app

COPY package*.json ./
RUN npm ci --only=production

COPY . .
RUN npm run build

EXPOSE 3000

CMD ["node", "dist/main"]
```

#### docker-compose.yml

```yaml
version: '3.8'
services:
  app:
    build: .
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=production
    env_file:
      - .env
```

---

## å¼€å‘æŒ‡å—

### å¿«é€Ÿå¼€å§‹

#### 1. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/David07aa/CookTip-Backend.git
cd CookTip-Backend
```

#### 2. å®‰è£…ä¾èµ–

```bash
npm install
```

#### 3. é…ç½®ç¯å¢ƒå˜é‡

```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡ç¤ºä¾‹
cp .env.example .env

# ç¼–è¾‘.envå¡«å†™æ•°æ®åº“é…ç½®
vim .env
```

#### 4. åˆå§‹åŒ–æ•°æ®åº“

```bash
# ä½¿ç”¨Node.jsè„šæœ¬
node scripts/check-database-images.js
```

#### 5. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm run start:dev
```

#### 6. è®¿é—®APIæ–‡æ¡£

```
http://localhost:3000/api/docs
```

### NPMè„šæœ¬

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `npm run start` | å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨ |
| `npm run start:dev` | å¯åŠ¨å¼€å‘æœåŠ¡å™¨(çƒ­é‡è½½) |
| `npm run start:prod` | å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨ |
| `npm run build` | æ„å»ºç”Ÿäº§ç‰ˆæœ¬ |
| `npm run lint` | ä»£ç æ£€æŸ¥ |
| `npm run format` | ä»£ç æ ¼å¼åŒ– |

### å¼€å‘è§„èŒƒ

#### Gitæäº¤è§„èŒƒ

```
feat: æ–°åŠŸèƒ½
fix: ä¿®å¤bug
docs: æ–‡æ¡£æ›´æ–°
style: ä»£ç æ ¼å¼è°ƒæ•´(ä¸å½±å“ä»£ç è¿è¡Œ)
refactor: é‡æ„
test: æµ‹è¯•ç›¸å…³
chore: æ„å»º/å·¥å…·é“¾
perf: æ€§èƒ½ä¼˜åŒ–
```

#### ä»£ç é£æ ¼

- ä½¿ç”¨TypeScriptä¸¥æ ¼æ¨¡å¼
- éµå¾ªESLintè§„åˆ™
- ä½¿ç”¨Prettieræ ¼å¼åŒ–ä»£ç 
- å‡½æ•°å‘½åä½¿ç”¨é©¼å³°å‘½å
- ç±»å‘½åä½¿ç”¨å¸•æ–¯å¡å‘½å

---

## æ–‡æ¡£ç´¢å¼•

### æ ¸å¿ƒæ–‡æ¡£

| æ–‡æ¡£ | è¯´æ˜ | é“¾æ¥ |
|------|------|------|
| é¡¹ç›®æ¶æ„æ–‡æ¡£ | æœ¬æ–‡æ¡£ï¼Œå®Œæ•´æ¶æ„è¯´æ˜ | å½“å‰æ–‡æ¡£ |
| README.md | é¡¹ç›®æ€»è§ˆå’Œå¿«é€Ÿå¼€å§‹ | [README.md](./README.md) |
| åç«¯APIå¼€å‘æ–‡æ¡£ | å®Œæ•´APIæ¥å£æ–‡æ¡£ | [åç«¯APIå¼€å‘æ–‡æ¡£.md](./åç«¯APIå¼€å‘æ–‡æ¡£.md) |
| åç«¯æŠ€æœ¯é€‰å‹æ–¹æ¡ˆ | æŠ€æœ¯æ ˆé€‰å‹ä¾æ® | [åç«¯æŠ€æœ¯é€‰å‹æ–¹æ¡ˆ.md](./åç«¯æŠ€æœ¯é€‰å‹æ–¹æ¡ˆ.md) |
| å‰ç«¯å¯¹æ¥æ–‡æ¡£ | å°ç¨‹åºå¯¹æ¥æŒ‡å— | [å‰ç«¯å¯¹æ¥æ–‡æ¡£-æ–°ç‰ˆ.md](./å‰ç«¯å¯¹æ¥æ–‡æ¡£-æ–°ç‰ˆ.md) |

### äº‘å‡½æ•°æ–‡æ¡£

| æ–‡æ¡£ | è¯´æ˜ | é“¾æ¥ |
|------|------|------|
| äº‘å‡½æ•°éƒ¨ç½²å®Œæ•´æŒ‡å— | äº‘å‡½æ•°è¯¦ç»†éƒ¨ç½²æ­¥éª¤ | [äº‘å‡½æ•°éƒ¨ç½²å®Œæ•´æŒ‡å—.md](./äº‘å‡½æ•°éƒ¨ç½²å®Œæ•´æŒ‡å—.md) |
| äº‘å‡½æ•°APIç½‘å…³ | APIç½‘å…³ä½¿ç”¨è¯´æ˜ | [äº‘å‡½æ•°APIç½‘å…³-README.md](./äº‘å‡½æ•°APIç½‘å…³-README.md) |
| äº‘å‡½æ•°å¿«é€Ÿå‚è€ƒ | å¸¸ç”¨äº‘å‡½æ•°å‚è€ƒ | [äº‘å‡½æ•°å¿«é€Ÿå‚è€ƒ.md](./äº‘å‡½æ•°å¿«é€Ÿå‚è€ƒ.md) |

### å·¥å…·æ–‡æ¡£

| æ–‡æ¡£ | è¯´æ˜ | ä½ç½® |
|------|------|------|
| å°ç¨‹åºå·¥å…·ä½¿ç”¨ç¤ºä¾‹ | CDNã€APIå°è£…ä½¿ç”¨ | [miniprogram-utils/ä½¿ç”¨ç¤ºä¾‹.md](./miniprogram-utils/ä½¿ç”¨ç¤ºä¾‹.md) |
| äº‘å‡½æ•°README | APIä»£ç†è¯´æ˜ | [cloudfunctions/api-proxy/README.md](./cloudfunctions/api-proxy/README.md) |

---

## æ€§èƒ½ä¼˜åŒ–

### æ•°æ®åº“ä¼˜åŒ–

| ä¼˜åŒ–é¡¹ | è¯´æ˜ | æ•ˆæœ |
|--------|------|------|
| ç´¢å¼•ä¼˜åŒ– | ä¸ºå¸¸ç”¨æŸ¥è¯¢å­—æ®µæ·»åŠ ç´¢å¼• | æŸ¥è¯¢é€Ÿåº¦æå‡80% |
| è¿æ¥æ±  | ä½¿ç”¨è¿æ¥æ± å¤ç”¨è¿æ¥ | å‡å°‘è¿æ¥å¼€é”€ |
| å†…ç½‘è®¿é—® | äº‘æ‰˜ç®¡å†…ç½‘è®¿é—®æ•°æ®åº“ | å»¶è¿Ÿ<1ms |
| æŸ¥è¯¢ä¼˜åŒ– | é¿å…N+1æŸ¥è¯¢,ä½¿ç”¨JOIN | å‡å°‘æ•°æ®åº“è¯·æ±‚ |

### æ¥å£ä¼˜åŒ–

| ä¼˜åŒ–é¡¹ | è¯´æ˜ | æ•ˆæœ |
|--------|------|------|
| å“åº”å‹ç¼© | gzipå‹ç¼©å“åº”æ•°æ® | ä¼ è¾“é‡å‡å°‘70% |
| åˆ†é¡µæŸ¥è¯¢ | åˆ—è¡¨æ¥å£åˆ†é¡µè¿”å› | å‡å°‘å•æ¬¡æ•°æ®é‡ |
| å­—æ®µç­›é€‰ | åªè¿”å›å¿…è¦å­—æ®µ | å‡å°‘æ•°æ®ä¼ è¾“ |
| è¯·æ±‚é™æµ | Throttleré™åˆ¶è¯·æ±‚é¢‘ç‡ | é˜²æ­¢æ»¥ç”¨ |

### CDNåŠ é€Ÿ

| èµ„æºç±»å‹ | CDN | æ•ˆæœ |
|---------|-----|------|
| å›¾ç‰‡ | è…¾è®¯äº‘COS | åŠ è½½é€Ÿåº¦æå‡50% |
| è§†é¢‘å°é¢ | è…¾è®¯äº‘COS | åŠ è½½é€Ÿåº¦æå‡50% |

---

## å®‰å…¨æªæ–½

### è®¤è¯æˆæƒ

- âœ… JWT Tokenè®¤è¯
- âœ… Tokenè¿‡æœŸè‡ªåŠ¨åˆ·æ–°
- âœ… å¾®ä¿¡OpenIDç»‘å®š
- âœ… Guardå®ˆå«ä¿æŠ¤æ¥å£

### æ•°æ®å®‰å…¨

- âœ… SQLæ³¨å…¥é˜²æŠ¤(TypeORMå‚æ•°åŒ–æŸ¥è¯¢)
- âœ… XSSé˜²æŠ¤(è¾“å…¥éªŒè¯å’Œè½¬ä¹‰)
- âœ… CORSé…ç½®
- âœ… æ•æ„Ÿæ•°æ®åŠ å¯†å­˜å‚¨

### è®¿é—®æ§åˆ¶

- âœ… è¯·æ±‚é¢‘ç‡é™åˆ¶(Throttler)
- âœ… æ–‡ä»¶ä¸Šä¼ å¤§å°é™åˆ¶
- âœ… æ–‡ä»¶ç±»å‹ç™½åå•
- âœ… ç¯å¢ƒå˜é‡éš”ç¦»

---

## ç›‘æ§ä¸æ—¥å¿—

### æ—¥å¿—ç³»ç»Ÿ

- åº”ç”¨æ—¥å¿—ï¼šNestJS Logger
- é”™è¯¯æ—¥å¿—ï¼šå¼‚å¸¸è¿‡æ»¤å™¨æ•è·
- è®¿é—®æ—¥å¿—ï¼šè¯·æ±‚æ‹¦æˆªå™¨è®°å½•

### å¥åº·æ£€æŸ¥

```bash
# å¥åº·æ£€æŸ¥ç«¯ç‚¹
GET /health

# å“åº”
{
  "status": "ok",
  "timestamp": "2024-10-16T12:00:00.000Z"
}
```

---

## å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•æ·»åŠ æ–°çš„ä¸šåŠ¡æ¨¡å—ï¼Ÿ

```bash
# ä½¿ç”¨NestJS CLIç”Ÿæˆæ¨¡å—
nest generate module <æ¨¡å—å>
nest generate controller <æ¨¡å—å>
nest generate service <æ¨¡å—å>
```

### Q2: å¦‚ä½•ä¿®æ”¹æ•°æ®åº“ç»“æ„ï¼Ÿ

1. ä¿®æ”¹Entityæ–‡ä»¶
2. ç”ŸæˆSQLè¿ç§»è„šæœ¬
3. åœ¨æ•°æ®åº“æ‰§è¡ŒSQL
4. é‡å¯æœåŠ¡

### Q3: å¦‚ä½•æŸ¥çœ‹æ—¥å¿—ï¼Ÿ

```bash
# äº‘æ‰˜ç®¡æ§åˆ¶å°æŸ¥çœ‹å®æ—¶æ—¥å¿—
# æˆ–ä½¿ç”¨tcb-cliå‘½ä»¤è¡Œå·¥å…·
```

### Q4: å¦‚ä½•ä¼˜åŒ–æ…¢æŸ¥è¯¢ï¼Ÿ

1. å¼€å¯SQLæ—¥å¿—
2. åˆ†ææ…¢æŸ¥è¯¢
3. æ·»åŠ ç´¢å¼•
4. ä¼˜åŒ–SQLè¯­å¥
5. è€ƒè™‘ç¼“å­˜

---

## ç‰ˆæœ¬å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | è¯´æ˜ |
|------|------|------|
| v1.0.0 | 2024-10-16 | åˆå§‹ç‰ˆæœ¬å‘å¸ƒ |
| - | - | å®Œæˆæ ¸å¿ƒåŠŸèƒ½å¼€å‘ |
| - | - | å®Œæˆäº‘æ‰˜ç®¡éƒ¨ç½² |
| - | - | å®Œæˆå›¾ç‰‡å­˜å‚¨è¿ç§» |
| - | - | å®Œæˆäº‘å‡½æ•°APIç½‘å…³ |

---

## è”ç³»æ–¹å¼

- **é¡¹ç›®ä»“åº“**: https://github.com/David07aa/CookTip-Backend
- **é—®é¢˜åé¦ˆ**: GitHub Issues

---

## License

MIT License

---

**Last Updated**: 2024-10-16  
**Current Version**: v1.0.0  
**Author**: CookTip Team


